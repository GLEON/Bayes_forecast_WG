######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-6 on 2020-05-31 15:30:49 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data.
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(x[k,j],tau_proc)
x[k,j] <- mu[k,j-1] + yr[year_no[k]]
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix
yr[k] ~ dnorm(0,tau_yr)
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
tau_yr ~ dgamma(0.01,0.01)
}
#monitor# tau_proc, tau_obs, mu, tau_yr, yr

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(533, 1676141708, -977602640, 1338030442, -2046527904, 1128374075, 919459888, 305596148, 866492856, 1165339589, 85369559, -1883124131, -1085746822, 1180420244, -965760272, -1395840870, 1605798687, 380453444, -1977457361, -903307459, 1330161496, 1732307422, -2058829151, 694034924, -804451148, 1176305154, -1268369587, -1196123086, 947020700, 656715780, -653493199, -1412992544, 1894223494, 1946144830, -264703186, -33169776, 865687238, 1142401910, 225486196, 772165326, -1999808405, 2129592152, 337146771, 859893580, -450990766, 787261097, -282120805, -845468749, -525660269, -262061682, 1485130881, 1349352973, -2117186290, 716428648, 1350611256, -391100183, -696988390, -1039826233, -1480295068, -696737849, 1147925440, -1022017809, 1814873408, 1002880676, -878110942, -2814011, 1063934165, -85365506, 867067389, -94727784, 1332535215, -1339243516, 557939521, -1091497043, 2125645328, 1002032432, -2023464081, -1858025551, -1279135293, -288158315, -169423567, -351152597, 639289118, 150494255, 391023961, 946757952, -1330815604, -535012851, 2025539375, -191922890, 893522768, 859778982, 1272607642, 1548945947, 2005693172, -1008816439, -1593697527, 673136899, -95301724, 1292151021, 68526134, -1740639786, 1235019235, 855200052, 625083591, -304642960, -1804797201, -399570021, -1107874594, 1048046078, 778655761, -1973310518, -502123031, 1627486061, 615369862, -740447156, 945923404, -92591599, -92034888, -942261715, 2003102057, 1599362761, 1417470547, -1519374343, -1153950162, -640687836, -323802506, 2092144943, -1652912207, 909876352, 312532699, 781385968, -162646332, 1841601024, 2062506793, 1503538022, 158246860, 501240497, -427115742, 1441068523, 1697329771, -515950926, 1022263755, -610167644, -487688956, -755924503, -2039408678, 1102565892, -1548987409, 175609897, -397504184, 175992244, 324611954, -1492764993, -359901448, 1213869958, -602287348, 1084935649, -1965561415, 1355464301, 1798949705, -1028010389, 1061917235, -1763223218, 813874349, 1866642446, 937700310, 610370362, -144494066, -2025774669, -88899597, 507488250, 1185663397, 2114858862, -1881831748, -1057307607, 352458832, 1662176717, 1382836525, 1156589046, -2050679451, 1162946111, -1071161671, -948802483, 1450804243, -1500574538, 283703088, -1391802439, -1087339596, 135847008, 1981711665, 1060650547, 566897977, -1203804392, 2046403466, -2058195948, 960826530, 52934336, 627073771, 589350055, 1301727312, -1868999868, 21476272, -1273091453, 1047119567, 1813926437, -747693299, 1302311003, 2139291844, -1162294502, -1677183541, -382739103, -1512322956, 226064015, -961369033, -1358916442, -829460657, 132298217, 1957352183, -1534518410, -1490527373, -926216313, -1330226311, -1090819010, 1708368673, 7149080, -1661888328, 929755722, 1312014775, 765641601, -103196924, 1219299400, -1084996647, -1893946390, -1067597129, 1374062799, -1719161538, -406307923, -1140591549, 1669277661, 1485782456, 2030295243, -1107004745, -437708657, -638373632, 1779904009, 344120422, 1373270366, -90729209, 170665828, 348801776, 1964513718, 2020426371, 1741548753, -1637768646, -2113854508, 2084923928, 534680802, -1180010095, 143746479, -1102342108, -2139982171, 45810493, 1661577613, -247423330, 957772494, -2097350106, -2018619342, 1724646945, 153699286, 1623402393, 2125346022, -803688014, 964431152, 1630012026, 40978195, 459258605, 1023502232, -1543774667, -1878461786, 1961805054, -803193384, 1416397406, 515005787, 1123030591, 1440922786, -336448471, 1889559037, -1964831634, -1504532368, -865439565, -2114485955, 2103232643, -609659204, 2099563551, 811677165, 2085147613, -707159178, -1614701308, -1278653422, 1005039407, -2083476277, 1851354601, -1428667347, -792651206, 1586567957, -111258953, -706405023, -1062504859, -2017633801, 20547004, 1980681001, -1491061292, 201976165, -268466323, 957366207, 138963420, 1190130767, -355010957, 493014531, 705812866, 391220303, 2045657996, 1724505086, -1204020760, -682356937, -1889329977, 429526290, -1114673726, 18823822, -472993605, -2125300196, -1700692888, 1641810155, -1511000035, 1397918929, 791811998, -210553990, 1952993816, -2041320055, 343188402, -965564457, -698842859, -1069064101, -845391697, -28304045, 534156673, -2012269579, -292964078, 913703499, -1850430339, 1740929069, -1226678915, -836467729, 1615033014, 507018008, -1934241120, 747456486, -1104584052, -403227969, -1870429584, -1259446505, -2087273143, 1951572781, -2034996655, 1308061878, 517976221, -836386727, 917407564, 954790889, -299964212, -2102110963, -1249955038, 1606394873, -1074647741, -1203511690, -1716421515, 906430650, 1608868179, 1997395179, -953784380, 1761857932, 337806255, -2111904295, 2090204395, -71630091, 1656041891, -185795128, 229344301, -1320258145, 1900881840, -1230210169, 508548740, 1245375337, 1565757456, -1017411316, 1598577078, -417415778, 380839618, 2142953594, -1153755025, -1392157656, -832176376, -1175181320, 410320428, -1388597059, -716331154, 700933798, 261615275, 2080056323, -156520141, 911840544, 1615498793, -861420958, 1533152620, -174773559, 523870841, -1018648486, -1055764546, 250335030, -765754804, 1701738585, -1696844864, -529791687, 50686966, -270128345, -726227613, 1499235581, -1158458747, -330632620, 1670756970, 629789907, 1951120096, 1975678668, 590985260, -916400654, 690880245, -587491185, -1226988433, 1789838294, -74020046, 617904336, 1875736545, -270225124, 426551868, 580123452, -818445094, -1453947481, 183938855, 1338822673, 2014680119, 888158943, -599587966, 1144154480, -1159728095, 1022533712, -613930135, -2072314909, -1044180073, 2039605006, -429284485, -956459680, -2059777189, 563753213, 472306614, -1408678744, 489559307, -554400275, -1161155528, 633906042, -1923870014, 222520465, -1970245397, -905735164, -1126245877, 722654880, -1645361552, 1038008424, -1206139754, 1248990160, -362194859, 1025582278, -741076730, -506087499, 823641776, -1401257539, 1656758603, 544031509, -1331778928, 1211603174, 1665139845, 1202871282, 1672278613, 1163601294, -1287561679, -1505748882, 1256587260, -1142573113, 457200244, 568966082, -1668059810, 1459565404, 1037111602, -1065974482, -740181991, -1065452130, 1483497989, 849677487, -1454110630, 1028440017, 1567473050, -1402410480, -341629546, -81949338, 1064642142, -54818408, -934991845, 1569334911, -1677979187, 416814009, -2086612720, -97406326, -556192477, 882668950, 2083655489, -1027634832, 259320923, -1081953405, 23301184, -598417732, -1619685950, -1473034309, -47660941, -418473871, -2071103931, 1550237111, 240841899, 1589570191, -1798091399, -961755695, -729201381, 518120896, -912770386, -1800850428, 1166096647, -1265902688, 704642989, -1020482117, 1968165219, -2141405934, 1101135354, 2002762168, 803391585, -486527151, 1192396211, 835221061, -720871064, 1316271626, 1395833726, -573630972, 689105040, 189603734, 1728952991, 80180896, 485732606, 1118791262, -365171710, 1136738956, -345522380, 1752505254, 1197421327, 1727808572, -1752390980, -1782076237, 1398625606, -427247768, -710782499, -733755745, 224327074, 1012381137, 1490569595, -1751081594, 1550986015, 1140949613, -530591019, -1712566873, -1403888854, 1514835039, -1916978046, -1151030798, -770230481, 1241515456, 736016810, -1676433005, -1299462964, 2142620849, 1214488049, 2071538480, 80686046, 955422875, -996000628, 215960954, 559436739, -998046079, 485029782, 712667796, -378731062, 1475106798, 145295196, -947115154, 359194328, 91285868, 1221226985, 1018015537, -310462456, -717308391, 1403300285, -836369095, 66586060, -969348147, 859544371, -418152091, -97036221, -1118406296, -1762832424)
"mu" <- structure(c(-4.96485289755023, -4.99642336330037, -5.06527775562486, -5.048693976701, -4.91757559547019, -5.04294583952918, -3.38595568836422, -2.28169551192428, -3.7819611141974, -4.58346935571498, -4.29569301092514, -4.17618420397164, -2.60527115901694, -3.68044526022731, -4.90928516176098, -3.35182692009375, -4.25999134938099, -3.48221868145016, -3.36186900843681, -3.16390679253655, -4.99160497155699, -1.90855529019152, -5.2625505546044, -1.70715903279377, -4.15383753388379, -2.15110349331721, -5.43652572349571, -1.33022524704811, -4.84250801365511, -0.624805824893097, -4.23179844466129, -1.12410171118851, -5.20230973111949, -1.5069931599769, -4.35445937342649, 1.12795790721355, -3.70866223698918, -1.73038401978604, -3.61847151498237, -0.0110523799620095, -3.55101075149361, 1.44961953243089, -0.821632122015638, -1.24905466647863, -1.98502149069368, -0.342621996626824, -2.29937262170327, 0.325716042653102, -0.0686311897291285, -0.0971186612454042, -1.92340832714312, 0.516131931122887, -2.34296964831668, 1.25054693632018, -0.306058206424965, -0.91866621086948, -1.04879386951851, -0.26405004966338, 0.473824138477865, 0.436285413811163, -1.93842999629894, 1.5098953311759, -0.482936157317835, -0.5852635911675, -1.15179238334302, -1.59182980526438, -1.28109149335823, 3.96435510881196, -0.786145814846354, 0.14346314211231, -1.15617991136363, -0.693956129152119, 0.1402289805107, 3.90678620679829, 1.0561991009886, -0.0772409631295958, -0.194498702180435, 0.725014626603717, 0.745409689834744, 2.27258864914851, -0.291941099830018, -0.241398758049855, 1.46447669372314, -0.0330607315649369, 0.102763364433759, 0.745812407763228, 0.259844055295272, 0.139902949886476, 1.0082741234503, -0.453851086293736, 0.0722479612415952, -0.694110510843786, -1.20801900495296, -0.539291326972129, 1.28132294395417, -1.05483790954536, -2.12650727082797, -1.28169979036444, -1.75241895356306, -0.427417104234703, 1.19822016804884, -0.642611229568392, 0.408517113425882, -1.65682791651592, -3.87731164640145, -2.27308611590787, 2.15462855672119, -2.56308457486192, -0.773495959506098, -3.18248969299, -4.13499529662267, -2.46843271714697, 0.750385053416792, -3.09307255996444, -1.25269088295972, -3.29839814533428, -5.35915235135683, -3.08165044921135, -1.28828001310799, -3.64922049881519), .Dim = c(6, 20))
"tau_obs" <- 1.18367847461719
"tau_proc" <- 0.749570222031025
"tau_yr" <- 70.991435630731
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"yr" <- c(-0.115464494458054, -0.0936847260463497, -0.110670914128895, 0.178066592185737, -0.140847229557368, 0.0190080110614028)
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(20069, 12166, 26290)
"mu" <- structure(c(-5.19737130948314, -4.89393232761666, -4.98134424597808, -4.95492735441961, -5.02550979328523, -4.92873917736894, -4.02722811163427, -4.06370265870971, -5.5985374861148, -4.7870208160523, -4.81014818946512, -4.2842821792183, -2.2933670894694, -3.98961675935644, -5.40862644509982, -3.64162927707882, -4.29762794442171, -4.61431702027137, -3.16949453859798, -4.41492654224754, -5.06405614306032, -3.3222762323888, -4.54682295755877, -1.38132401106097, -3.58486126529081, -1.50288391720448, -3.63211876636292, -2.90917602477042, -3.82588882820529, -1.36484485734013, -3.88070773874749, -0.13650133821632, -4.36727699466742, -3.05756436053491, -3.41619473872296, -0.681092881461636, -2.94936620901732, -2.00725992332584, -5.98770914059762, -2.96425999610881, -2.52712677044194, 0.366247277136171, -1.7627022093458, -1.96897882848351, -2.52990366478144, -2.30854548918867, -3.11619658325576, 1.45220026239197, -1.09869731568224, 0.379837182479002, -1.94179904978705, -0.841857098221598, -2.5760458755577, 0.415960186886922, -0.627947514157448, -0.39195461252415, -1.24310071793012, 0.698698460507637, -1.76025215487924, 0.684268126281454, -1.36870009966821, 2.11467468314827, -0.167730861400674, -0.47015895909233, -1.19027676749187, -0.0475225350192447, -2.61842526932202, 1.83449508399741, -0.369284539062981, -0.755109964771621, -1.25670398999107, 1.13316554952231, -0.261876879285337, 3.05208708394162, 1.16630316743167, -1.54500597487074, 0.0395613938737261, 0.263129032252564, -0.0283907863190838, 1.57574304482134, 1.54328526130626, -1.77533199145008, 0.546209202544162, -0.536143659378397, -1.1441231752841, 0.226230513859303, -0.394591219582494, -1.1906411130277, -0.460577053514195, 0.0650110908383207, -1.32800170206083, -0.103402590932583, -1.01377187394493, -1.56229966012491, 0.427752405859585, -0.786687903020779, -1.33585112565602, -0.310378742121671, -3.02867830578812, -1.02524531756644, 0.624615537020802, 0.556664716708213, 0.758933783282229, -2.06438454202559, -4.60164501543078, -1.98852524910021, 2.78300413480749, -2.0759531010273, 0.480307558656182, -2.59072969572202, -4.4349179952139, -3.18518130692876, 0.878126688355397, -2.62571682243791, 0.44718965041697, -2.65425038286548, -5.50321123709863, -3.15764073061828, -0.541849495898977, -2.20599249915257), .Dim = c(6, 20))
"tau_obs" <- 1.36199188412732
"tau_proc" <- 0.693014525094718
"tau_yr" <- 2.69052402591291
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"yr" <- c(0.243341899849714, 0.275131996069899, 0.280497296403779, 0.276061833998566, 0.0925907702074408, -0.0152143371992663)
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(2043789284, 392503210)
"mu" <- structure(c(-4.84267980056971, -4.99448534524441, -5.01874319554934, -4.79906426440775, -5.02835227893598, -4.89089190932735, -3.87023663706809, -3.56330251138654, -4.99691197775418, -4.71807956039143, -4.53608436528793, -4.5134162276047, -5.25454187362732, -3.01222407657837, -4.95676176579105, -3.44698753962831, -5.2665656566561, -4.87872421118749, -3.06823244337282, -3.49473656248971, -5.21799335257821, -2.89600315914066, -3.25110133117278, -2.79543365222797, -4.28334663655206, -1.72336533317544, -4.7854056513103, -1.44334369019968, -3.9211229643577, -1.43260450497105, -4.26770662007221, -0.646564735037088, -4.68393960539896, -2.8722522000909, -3.89150307737461, -0.14235017488238, -3.24122646214933, -2.14279207555663, -4.14869872526453, -0.966510927544326, -4.14866810956997, 0.384669001085701, -1.59334074364744, -2.31127211562452, -2.44777644301135, -1.37959865329541, -4.15189032952001, 0.241259584162662, -1.22042224613644, 0.704896689583457, -2.47287701043986, -1.40916755712073, -3.2356346638849, 0.34510309728781, -1.03905569916026, -1.34517684484736, -0.949527320761416, -0.432386172045229, -1.84187989382478, 1.05005693006188, -1.76026681469848, 2.29526333037394, -0.308586283242297, -0.356665983596812, -0.760481099750397, -0.301941303607247, -1.54686196469561, 3.61675660333523, -0.906770561203664, 0.172510157279623, -0.896172926703271, -0.47392007464189, 2.48186893228779, 4.21619952265852, 1.02877828990288, -1.34547326495942, -1.29494084260795, 1.38226058854136, -0.514022217411135, 0.683597152970658, 0.616365275906951, -1.22419389290521, 0.92912474828637, -0.423372754970854, -0.364982829270141, -0.289279163164491, -0.804835170344848, -0.966612537843418, 0.361683824521541, -0.374547052873845, -1.18996494650049, -0.872702427464507, 0.0290780746847084, -0.470897082153927, 0.638605707739711, 0.606735934356005, -0.888794223191928, -1.59853550933639, -2.27504109952041, 0.481416616369766, 2.52962226812278, 0.301338829316842, 0.962927762381896, -2.58031101396178, -4.30950806890655, -1.0820284934985, 3.43399650418149, -1.58258276082364, 0.179944895378999, -3.83074664317725, -5.40687498068757, -3.32483349156231, 0.210292218217983, -2.16227447179834, -0.530563086987665, -3.43478463114567, -4.52521537161287, -4.24058075798976, -1.16778304906167, -2.24135984487108), .Dim = c(6, 20))
"tau_obs" <- 2.46622982991339
"tau_proc" <- 0.635431219730433
"tau_yr" <- 41.3416259917501
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"yr" <- c(-0.0379231346294206, -0.00705884227111242, -0.12954375969346, -0.344290338496307, 0.201173034691735, 0.270361656644748)
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-3.85980369014249, -2.86343927118061, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.26355862228935, -1.85743696973239, -4.26355862228935, -4.95159275346247, -4.95159275346247, -4.26355862228935, NA, -3.85980369014249, -4.95159275346247, -2.86343927118061, -4.95159275346247, -4.95159275346247, -3.1683696152567, -3.57297780368645, -4.95159275346247, -1.910055720008, -3.57297780368645, -1.9584839181152, -3.85980369014249, -2.55012206191651, -4.26355862228935, -0.661508725238449, -3.57297780368645, -1.45640727768747, -4.95159275346247, 0.658075359447239, -4.95159275346247, -4.26355862228935, -3.57297780368645, 0.285233178195202, -2.46425572610276, -2.64405992074449, -4.95159275346247, -1.16773044583689, -2.64405992074449, 1.31776713186147, -1.51835421625552, -2.74774570870643, -1.51835421625552, -2.11966258526556, -2.55012206191651, -0.0607354836898151, -0.581476769814426, -0.703051798172265, -1.81356262524385, -1.23762564284707, -2.46425572610276, 0.545848385406104, -0.206935445467576, -2.17972929416229, -1.45640727768747, -0.689011472830919, -0.999476338867932, 0.269318592960969, -1.0186775184919, 2.75703540249097, -0.163611130691224, -0.376772502579018, -0.606837133839059, 0.537704412220319, -2.55012206191651, 3.57834089259093, -1.731198082625, 0.166422615608164, -0.825371688593113, -0.532607577803059, 1.18205601731843, 3.79213688288921, 1.41344057964001, -1.81356262524385, -0.594076560473089, 0.897748741042104, -0.00997747407868495, 1.55436319024868, 0.871741857734603, -1.26205351705275, 1.06955146236881, -1.16773044583689, -0.569033760516405, -0.689011472830919, 0.0592798458080164, -0.376772502579018, 0.464408088230409, 0.142429802890188, -1.31277577255996, -0.891422193820534, -0.761271566892886, -0.556743678768707, 1.43890392109862, -0.891422193820534, -2.24363589004942, -1.85743696973239, -2.74774570870643, -0.429134835254822, 2.24602237489292, 0.679591787844505, 1.5193101505469, -2.86343927118061, -3.85980369014249, -1.1024030572059, 4.40235696751028, -2.24363589004942, NA, -3.85980369014249, -4.95159275346247, -3.57297780368645, -0.761271566892886, -3.85980369014249, -0.269093075706006, -3.01446390455736, -4.95159275346247, -3.3503483160569, -1.42681583503013, -2.00937729712331), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
