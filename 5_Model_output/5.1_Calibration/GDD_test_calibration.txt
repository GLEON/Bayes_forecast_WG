######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-04-20 12:35:17 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
#gap-filling for covariate
covar[k,j]~dnorm(week_avg[j],tau_C_proc)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc)
lambda[k,j] <- beta1  + beta2*covar[k,j] + beta3*(covar[k,j]^2)
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic)
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1)
beta2 ~ dnorm(beta.m2,beta.v2)
beta3 ~ dnorm(beta.m3,beta.v3)
tau_obs ~ dgamma(a_obs,r_obs)
tau_C_proc ~ dgamma(0.01,0.01)
}
#monitor# tau_proc, beta1, beta2, beta3, mu, tau_obs, tau_C_proc

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(23677, 13100, 19865)
"beta1" <- -0.62472509930741
"beta2" <- 1.26920790158651
"beta3" <- -1.34134506676342
"covar" <- structure(c(NA, -1.47395318066167, -1.47395318066167, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1.57692133246384, 1.57896346461959, 1.69555390188749, NA, NA, 1.61218701828914, 1.54510038727315, 1.63749536585465, 1.70066864092477, 1.61181943845195, 1.67692206303141, 1.68867152791617), .Dim = c(6, 20))
"mu" <- structure(c(-4.99757329720874, -4.75045956080949, -4.96827509749794, -4.99707388037772, -5.05830821161938, -5.11016795024219, -3.82987195049934, -2.5495863002039, -3.86855962769322, -4.777674552493, -4.32249132406013, -4.00996470146253, -5.0392512684189, -3.88434049517552, -5.59613557987687, -3.3284114265276, -4.82634089244497, -5.94341305154754, -3.3798286031562, -3.69906023057493, -5.66090102582487, -2.14887741680408, -3.41493593052483, -2.75315164059494, -3.01819226108002, -1.63177333332081, -3.26085529018607, -1.36743238746029, -3.87730989433973, -0.707422870109844, -3.90633640612079, 0.0240981449106762, -4.18754233270833, -3.56987516474369, -3.71956421844184, 0.355622348824702, -3.73166564622556, -2.11841439888787, -5.63431156370731, -1.40360915074626, -2.40805254057059, -0.219852692155746, -2.5664002895406, -2.10217325316045, -0.545945015410299, -2.65094562977119, -3.42315926107329, -0.245753157955453, -0.667984105098779, -0.729440024247473, -1.40118310965325, -2.0800372856842, -2.86379493342767, -0.710450396007445, -0.469359908462469, -1.74806751084126, -1.15199104062174, -1.24248651009467, -1.12564359809735, 1.3236263961974, -1.15634328578242, 2.65957713523504, -0.164682589306775, -0.995964801623741, 0.237451880376693, 0.748215772396602, -1.93562978907422, 2.71783983482232, -1.46483774011067, -0.589864419111445, -1.08303768268036, 0.848176240459609, 1.60252081389368, 2.96348247142878, 0.316663583514932, -2.16643245352387, -0.0364572243984017, 0.158597858985899, -0.449660284961823, 1.56334375720569, 0.633638658112544, -0.224387106689383, 1.49606059321524, -0.460358433488222, -1.54833292811871, -0.263040730601774, 0.27054263727278, 0.1325040155453, -0.500034180254871, -0.0963485474477334, -0.652049056134301, 0.0881302416930617, -1.09181575440661, -0.952934923805713, 1.4289364600164, -1.07216220742198, -2.98646069108, -1.67233560860011, -2.54717178011786, -0.191001779379964, 1.45362481916182, 0.46047976894176, 1.46235519788402, -3.36687741155071, -4.0309774914062, -0.821382351664408, 3.38765505475498, -2.22679089477042, 0.175781861688565, -4.27321030540636, -5.79352504677795, -3.44691411465579, -0.775029609675291, -2.8686360598058, -0.311554344253872, -0.996482209592027, -4.76868369856739, -3.50340913498546, -0.720617337536326, -1.86214221705464), .Dim = c(6, 20))
"tau_C_proc" <- 149.548445592374
"tau_obs" <- 2.35489569944077
"tau_proc" <- 0.388207288007523
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.635789120678312, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -2.57275553083381, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1948373965, 1061271844)
"beta1" <- 0.303796572738732
"beta2" <- 1.33201679967303
"beta3" <- -1.48706970789935
"covar" <- structure(c(NA, -1.47395318066167, -1.47395318066167, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1.56217760510723, 1.52478010694008, 1.74055406039542, NA, NA, 1.70880702303946, 1.52541466220975, 1.54553822186163, 1.71687959155901, 1.5841586188571, 1.63856704926684, 1.50376860087275), .Dim = c(6, 20))
"mu" <- structure(c(-5.06091040250427, -5.0601415551221, -5.11778784127348, -5.12068935075873, -4.94140166656112, -5.03726560431272, -3.98634466779547, -3.30362791200026, -4.88304867795626, -5.32123773714469, -4.69111129948709, -5.0896865622222, -5.71430365284565, -4.2266607581078, -5.05678774307673, -3.25921503252399, -3.45389942201996, -5.52193904224221, -3.67604133341537, -3.99768571326884, -4.78179795242104, -1.68927875800172, -3.39682860857444, -0.922330828280995, -3.22964281303301, -1.89376565003045, -3.57365607920367, -0.86016347705515, -4.73826403352838, -1.57633610908759, -3.93855778671763, -0.949434974214137, -3.95183826464588, -3.42045117008776, -2.79913089748403, -1.27921849161541, -1.45410420856583, -2.48886604158749, -4.40942963903308, -0.26321241675503, -1.30351211814525, -0.285833387182838, -1.27031324413964, -2.05752906788613, -2.68012207772289, -3.13574646961193, -1.42902114352442, 0.837718356822057, -1.54405326229967, -0.57843710763547, -0.790699817994957, -0.68045436120361, -1.28610281631129, 2.07989509484395, -0.643216747898759, -1.71006945698233, -0.879545063718781, -0.553238983703789, -1.17234283377148, -0.377778288239717, -0.427259064512647, 1.01953762291083, -0.432204609800553, -0.418274029653103, 0.386289803926659, 1.51196385481642, -1.98542379591343, 2.38273282385668, -0.795455164985135, 1.00445345828051, 0.56342673663973, 0.0577270348523937, 1.20201314978748, 3.96031364002045, 1.33209575753576, -1.4464649093427, -0.567816410545004, 0.616788720877723, 1.62322380371785, 1.4604534089458, 0.903479342435153, -0.937925400511323, 1.10042197979134, -1.19949054506782, -0.859686871137393, -0.938876254839938, 0.481397565660634, -0.089577107873117, -0.220114631341901, 0.0136166827225834, -1.24648274098733, -1.26882908719947, -1.30865638536672, -1.66903630632803, 0.182921348022446, -0.263111366759394, -1.33705723483682, -1.61141727241657, -2.48089524859983, -0.349241640496107, 1.98231035840617, 0.0363751737062023, 0.149149348519649, -1.37311060440077, -3.36343215859532, -1.4774920774915, 3.49237630105696, -3.36963054599824, 0.765090762344573, -3.97141849511867, -4.53810966451974, -2.76476300493442, -1.25620686189496, -2.71361891616206, -1.02023154106036, -2.76441544436414, -3.90752777651888, -2.69020528088514, -0.426976762006165, -1.08915465987056), .Dim = c(6, 20))
"tau_C_proc" <- 184.746966433417
"tau_obs" <- 1.69450306355405
"tau_proc" <- 0.463941845189781
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-1931152425, 1507858061)
"beta1" <- -0.482857085106554
"beta2" <- 1.33278297967565
"beta3" <- -1.28400547975216
"covar" <- structure(c(NA, -1.47395318066167, -1.47395318066167, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1.64290647723706, 1.5635173838428, 1.63502953218458, NA, NA, 1.49654372387019, 1.68345775088214, 1.60659900331566, 1.77746499918569, 1.60498652541803, 1.5543044775677, 1.55061107165061), .Dim = c(6, 20))
"mu" <- structure(c(-4.92374950285172, -4.8309952816396, -4.93969719557469, -4.92746032494691, -5.17177203776498, -4.94812546217542, -4.03973692039652, -3.80271698593185, -4.6910253746458, -4.28474032594469, -4.4823597427152, -5.12148036320117, -3.03362740383021, -5.53346096932152, -5.73982258287667, -3.39404535823646, -5.95338782978209, -4.40934810656059, -4.39448167418726, -3.1531700922156, -4.87449036525713, -3.25737182058759, -3.30779298127454, -2.60771946313168, -3.55881104560455, -2.43472807128468, -4.35668887611739, -1.02883093179168, -3.34321727268558, -2.4448116102288, -4.34640676751571, 0.60204087139996, -4.14696805788118, -4.47714451981186, -2.68013392135073, 0.260178484941607, -2.86149409291038, -2.42076241631165, -4.67843755952681, -0.572536162155, -2.75196325696299, -0.234765242285212, -1.2483662932424, -3.06011255356849, -1.60446970449039, -2.18295177050579, -2.86401342439932, -0.664123829689086, -1.95145235348311, -0.245675167996418, -2.21094235766673, -3.03461718816974, -2.57328354696413, 0.524590002269982, 1.6253238607286, -3.1929943848271, -0.726195489621325, -0.769702421911115, -1.79147193997615, 0.140934829320285, 0.280395588087113, 3.05650686139311, -0.694693029379546, 0.0869510315102096, -0.728726461510185, 0.171321247780204, -1.89020042839209, 2.92398353389782, -2.39682737930059, 0.816106371922726, -0.707165907228036, -0.0235103854869212, 1.73228102428337, 3.15149758854786, 0.361184218852424, -1.29777428129103, -1.76673779364209, 0.911754799961289, -0.397873681770028, 1.34667640929507, 0.0456507084818711, -1.87642393952307, 0.885447099080771, -0.149108121328986, -0.171535385393244, -1.10510761305331, 0.281183666110705, -1.1237000134653, 1.07646647061041, 0.265798089067429, -0.310622557166211, -2.03124025564953, -0.557472961225897, -1.60194621240542, 0.740172150273018, -0.380409961219179, -2.59063967079705, -2.38232123461863, -1.88044185339104, -1.09005965377779, 1.29926391819475, -0.309339719937647, 1.22142317043881, -2.47900534025968, -2.47428865782853, -1.45398395628644, 3.12569275229824, -1.85038442102093, 0.533345907690655, -2.96903791684616, -4.94830858882997, -3.10763563876713, -1.16406306745138, -2.861866423215, 0.14234813976291, -2.73152985467883, -4.24824747532726, -3.49457715444049, -0.870563269520593, -2.35066277163388), .Dim = c(6, 20))
"tau_C_proc" <- 146.086763381108
"tau_obs" <- 1.68727910202292
"tau_proc" <- 0.545164390399658
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.635789120678312, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2.57275553083381, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-3.85980369014249, -2.86343927118061, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.26355862228935, -1.85743696973239, -4.26355862228935, -4.95159275346247, -4.95159275346247, -4.26355862228935, NA, -3.85980369014249, -4.95159275346247, -2.86343927118061, -4.95159275346247, -4.95159275346247, -3.1683696152567, -3.57297780368645, -4.95159275346247, -1.910055720008, -3.57297780368645, -1.9584839181152, -3.85980369014249, -2.55012206191651, -4.26355862228935, -0.661508725238449, -3.57297780368645, -1.45640727768747, -4.95159275346247, 0.658075359447239, -4.95159275346247, -4.26355862228935, -3.57297780368645, 0.285233178195202, -2.46425572610276, -2.64405992074449, -4.95159275346247, -1.16773044583689, -2.64405992074449, 1.31776713186147, -1.51835421625552, -2.74774570870643, -1.51835421625552, -2.11966258526556, -2.55012206191651, -0.0607354836898151, -0.581476769814426, -0.703051798172265, -1.81356262524385, -1.23762564284707, -2.46425572610276, 0.545848385406104, -0.206935445467576, -2.17972929416229, -1.45640727768747, -0.689011472830919, -0.999476338867932, 0.269318592960969, -1.0186775184919, 2.75703540249097, -0.163611130691224, -0.376772502579018, -0.606837133839059, 0.537704412220319, -2.55012206191651, 3.57834089259093, -1.731198082625, 0.166422615608164, -0.825371688593113, -0.532607577803059, 1.18205601731843, 3.79213688288921, 1.41344057964001, -1.81356262524385, -0.594076560473089, 0.897748741042104, -0.00997747407868495, 1.55436319024868, 0.871741857734603, -1.26205351705275, 1.06955146236881, -1.16773044583689, -0.569033760516405, -0.689011472830919, 0.0592798458080164, -0.376772502579018, 0.464408088230409, 0.142429802890188, -1.31277577255996, -0.891422193820534, -0.761271566892886, -0.556743678768707, 1.43890392109862, -0.891422193820534, -2.24363589004942, -1.85743696973239, -2.74774570870643, -0.429134835254822, 2.24602237489292, 0.679591787844505, 1.5193101505469, -2.86343927118061, -3.85980369014249, -1.1024030572059, 4.40235696751028, -2.24363589004942, NA, -3.85980369014249, -4.95159275346247, -3.57297780368645, -0.761271566892886, -3.85980369014249, -0.269093075706006, -3.01446390455736, -4.95159275346247, -3.3503483160569, -1.42681583503013, -2.00937729712331), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"covar" <- structure(c(-1.47506962539401, NA, NA, -1.53433173690588, -1.486360659107, -1.52247523529283, -1.36603717586028, -1.52809175542806, -1.52789200785483, -1.38583570450965, -1.39411891582185, -1.39354489096685, -1.22220373950612, -1.38627966509115, -1.35194260892364, -1.26132199053278, -1.25508386050683, -1.23916428509006, -1.09504444569047, -1.27969040741003, -1.22072781423615, -1.1179544224018, -1.1284373630148, -1.08281723998497, -0.916497823170702, -1.06077601186386, -1.04951748018243, -0.955112186021456, -0.994191221780691, -0.916978343989448, -0.733928334284537, -0.866125898937863, -0.878485248240111, -0.783895707334301, -0.820580633747737, -0.744589692718145, -0.556347518967815, -0.665083298491096, -0.67863144852991, -0.609352474854029, -0.663926928708574, -0.545185191741184, -0.364926127700033, -0.432885811992663, -0.464668864168154, -0.423418653321461, -0.41806991472683, -0.302617349703137, -0.163303896717454, -0.198982655860588, -0.241421739302987, -0.219353011419508, -0.204191176940679, -0.11795357971059, 0.0480242975618309, 0.0184072031103817, -0.0105162236472672, -0.0218194134764557, 0.0109612839071116, 0.0937487296710198, 0.267278496408246, 0.229842312785139, 0.210833726552899, 0.166044330134879, 0.209263598330522, 0.301540850279442, 0.479293132170686, 0.443979323914959, 0.433941467156964, 0.368456717109217, 0.399688753931386, 0.477983391652153, 0.712723145832028, 0.656403118200367, 0.640501198540187, 0.568190156302891, 0.583389505659345, 0.693414372339723, 0.946911437875926, 0.851883424310876, 0.849283334530982, 0.762565699935236, 0.764144328071555, 0.878100832015673, 1.09104818558311, 1.04458635685864, 1.04172653769259, 0.955551159832526, 0.949289581372212, 1.10086814367035, 1.28470450261, 1.2389572229862, 1.23790214162371, 1.13263838050753, 1.13886084441779, 1.27323410525824, 1.46279615810023, 1.402339241699, 1.42390269449437, 1.30187770126085, 1.28274885575537, 1.43971587561686, 1.60057933114937, 1.53151730120974, 1.58571233449377, 1.45920683855604, 1.44207097502981, 1.60671950869375, NA, NA, NA, 1.59786431713815, 1.58454294787987, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
"week_avg" <- c(-1.47395318066167, -1.4255329179424, -1.31957559283993, -1.18263729448394, -1.00263291935263, -0.81555870408047, -0.620557393324296, -0.392427522119108, -0.170762356576946, 0.0563665680213546, 0.276737467256153, 0.490949290709061, 0.711888664152092, 0.923827204753206, 1.12712679734375, 1.32473221167074, 1.44402999991057, 1.5719920476924, 1.5965474146004, 1.5965474146004)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.m3" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"beta.v3" <- 0.001
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
