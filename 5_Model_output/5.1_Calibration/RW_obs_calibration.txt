######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-03-27 16:09:34 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(109, 1422397071, -2067372269, -1860574034, 787626718, 1756579029, -508448062, -1219762289, -1109002293, -127258968, 960095666, -465362329, 93500530, -847518057, -1717184323, 1431153353, 2095057492, -390691240, 831023153, 1391358232, -1879379348, -774389045, -2113109784, -852618781, 797099263, 2092279815, -604837253, 1844145328, 1537659884, 1829682081, -220607895, 671945288, -1849629618, -1776573695, -594722298, 908536356, -92966337, -695342486, 1268465824, -1061792843, 296447794, -1662951941, -1938000843, -570175679, -303654472, 902699985, -36396845, -2293497, 802443641, 53213976, 625950041, 1189826435, -389694540, 397110772, 1788955607, 644163083, 540621600, 1450010063, 1111671418, -1391778202, -1652092999, -705997384, -1292253336, -711808953, 2107380854, -150359342, -1679203684, -1301151616, -581863227, 602000066, -640935402, 507463707, 2121312031, -1497367882, -2117299745, -76932313, -591353515, 159107753, 1580877057, -1660870892, 1089323571, -1055573812, -493797071, 18047755, -1178030793, 215523986, 1069002308, 784487360, -202488779, -177628727, -1910280276, -2142782744, -549832693, 976519333, 832098426, -1529430397, 1545420197, 820260503, -373711926, 1293909115, 1534801818, 491654008, 114686170, 401002492, 1233102642, -112909887, 1370960120, 1102810663, 1869927766, 2144834742, 1235684058, 409476906, 1722358550, 1380498059, -497425837, -903017760, -559516381, 978847594, -704946854, -1458140813, -111772823, -582870824, 1062344299, -856893128, -12013829, 1017519808, 1766935104, 1701179854, 1466239900, 563703743, -869891764, -427991709, -1029306639, -1258341908, 363190304, -794084478, 1543687015, -319850339, -1798647399, 1077501985, 939565238, -1510778150, -2100818020, -1052784387, 1315342045, -370364773, 13081209, 2120908286, -2058060822, -520988651, 1297346494, -633839920, -1931419381, 132543322, -368697452, 2054994817, -1866191708, 639555477, 2077234488, -2119381484, 1309537298, 773417313, -129391605, -1154696203, 233124539, -975032809, 679602583, 189580722, -419665577, 1861722524, 673059865, -1409596161, 889755430, 1104961098, -901005580, 1697864324, -1452127069, -1940287998, -728372882, -819853842, -2045823221, 1754025921, 2003276745, -1972792553, -619345754, 411271415, 1077015564, 722817757, 1048526334, -1597766812, 1416617599, 1678426133, -81260951, -1513767892, -295551751, 2030326449, 805792337, -1140341912, 1350865584, -204062974, -239435267, 923382275, -143566887, 1569887910, 574610365, 178693362, 1479231121, 2145705992, 1257952267, -1813666487, 1812636179, -2115478534, 1522346688, 83284039, -179918749, 103210490, 1197889175, 760460037, -1115993567, 973510455, -1865978324, -1132792052, -1564382743, 636761660, -1718074721, 1139519466, -1261665647, 280417800, -541681059, 1989018187, 1203558776, -908973286, -1446841062, 198023261, -1738121741, 1876921248, 1279359520, -1153089789, 1661815111, 2029167118, -1158737069, -504611057, -1535712793, 1791826120, -754249159, -1310376226, 764731931, -832908942, 1631630727, -1322224958, -611467174, 1799197893, 783013140, 1848708936, -459756112, -1194694981, -1726977294, -621059027, 2047178411, 2000176247, -1301201993, 1895600391, -1669139419, -227872499, -1020155034, 1328220754, -570771950, -1889460108, -412505462, 1318696608, 61938745, -1523723716, -1035290344, -664386248, 1171133622, -1296619762, 587663737, 313362802, 56858568, -1277007176, 676293436, 2052719510, 230753312, -1273334308, 1248826195, -721419344, -1900210277, -1003205076, 1504398659, -2085630747, -1574194597, 197440521, -1090425857, 912403147, 1439893846, -1368475765, 2104287743, -912614651, -1944518821, -1965723693, -940390618, 721949340, 1244154570, 692948692, -1476572604, 583797766, -1429967128, 768983368, -146614463, -1662622272, -1918785904, -1444372215, -1324963393, -1464002033, 1645689285, 2033678731, -1653375037, -490436868, 758427263, -815439125, -979000386, -1657697547, -1116895535, -766197291, -2002383750, -1689323288, -1964264582, -883014016, 622876657, -1790758449, -1869518332, -337958783, -685016106, -84148793, 1565774235, 1727936320, 1025426325, 620645834, 288775423, 2101318318, 1604553624, 2004925268, -1261740382, 395525733, 1560549089, 903207140, 966619400, 521147837, 1387060255, 1615940041, -274461349, 800231490, 1683622231, -1095678400, -661348462, -1244068399, -1222051852, -1544173145, -1220553760, 336242175, 1689314424, -148906659, 388362947, -385378356, -459991437, -1691001022, 789438318, 1583144000, 758678800, 1787330905, 1519197638, 1340153160, -1989001187, -1126717172, 375384556, 1618192268, 1850420940, 156423316, -1369711447, -745539396, 1454301571, 1778492569, 585875400, -673294567, -2068581470, -793075290, -18348335, -1718768513, 209328350, 7004525, -1698523389, -1266763822, -477734779, -138974864, 118724221, 960149298, -934890364, -439370433, 51195612, 1192697368, 1285455083, -1771015371, -465445172, 290919985, 970395790, -1949303706, 1033444078, -2060901370, -1836998963, 443192389, 1197856955, 1216663549, -1221844848, 1591407070, 301322287, 945396319, -1996933641, 1058541563, 1394323539, 1263094542, 1994316433, -1637742613, 440458262, -611791189, -724771209, -1999170811, -1860929219, -1956433041, -1605520886, -1269970401, 823006761, 1630473467, 619622084, -825975593, 546508832, -1019445500, 855980598, -1330117847, 1035952402, -1623364871, 518386793, 1613735102, 1482872481, -2084592216, -1127676067, 1007451571, -1108683684, 1174604180, 1270751159, 704032962, 1213704186, 941292588, -1329490422, 1221421949, 1405886652, -152723914, -1463686532, 2083080396, 715580671, -908531210, 1911274799, 1910825281, -1309348890, 330498939, -1822371624, -1055620235, -187757864, -1693331537, -526711934, 1903710125, -1395723303, 1258114984, -811118779, 765786513, -2047541014, 1621852368, -1914962121, -1819275945, -1297155720, -916242443, -440604618, 1051852756, -678274197, 1470721364, -1332925349, -1044349517, 1535005422, -336162231, 1659040341, 1317666815, 1133792080, 1553506042, -274180019, 1067063998, -1686067670, -1902039855, 1559932769, -105608020, 1905434370, -1130430933, -1402217005, -1138943197, 819085041, -733329155, -1216650141, -491211320, 109592358, -1074207186, -271241440, -95897640, 371736512, -1588113538, 893003096, -753772041, 2073990196, -225830854, -1104004861, 210248078, 1296567526, -1162187381, 4373640, -985717084, 908633035, 827159020, -1017652792, -557186819, -62653415, -1692944107, -1490565894, 604878562, -1343151587, -1167075109, -1380772067, 696225894, -2023690337, -880308101, 128239877, -2052197992, 1801961493, -1435224352, 414677006, 2014923948, -721638830, 187558542, -1965518250, -1314644991, -885989375, 1775342035, 1921707388, -2129512561, 316689489, -360388533, -820926626, -1169556688, -94855722, -828713630, -808244358, 1894504644, -1164550692, 773282617, 559816844, -959699560, -646363871, 532333881, -1177525031, -114758494, 979872767, 1970596355, 1569244664, 2011814770, 147226767, -1106910665, -965604301, -1568917531, 1074868217, -853618297, 306093634, 1176378102, -1753869439, 760233707, 712447355, 694561105, -2122544114, -772271951, -1839494694, 757644304, -770423339, -394684946, -151517311, 2137913039, -583123317, -442377109, -926795953, -2112724598, 1296310785, -1345086181, 127294206, 1890093628, -56247116, -1866336651, -1712847348, 1461178146, -1376397803, -1644293509, -1877363432, 1091405884, -565990592, 1861977555, -631612371, -1350533773, -496523916, -260474000, -594881645, 1520839779, -366232314, 2116453614, 2094767132, -1943985367, 2113850157, 215555596, 1449930244, -670335218, -804570661, 1795178015, 1453525671)
"mu" <- structure(c(-4.91608567098625, -4.99993789839268, -5.07734596347793, -4.87893024846477, -5.14508208765337, -5.0447880323625, -4.33126109702224, -3.65780138957923, -4.93302616591475, -4.5277863406582, -5.28183291979736, -3.91513813215442, -3.71909209514295, -4.87810443880758, -5.81151969896686, -2.65983885619055, -5.02949508469289, -4.97126171997217, -4.54380341281068, -4.52181206689362, -5.78671403814112, -1.8724577789664, -4.41023632656301, -3.41718306909048, -3.94929165975686, -2.0320073984286, -4.69257815572437, -1.91640985741822, -4.44830260533321, -2.26834161805955, -3.37615316964563, 0.0256523153020561, -5.1210158056125, -2.89472315720361, -3.86754758695367, -1.04046534363447, -2.6748070190931, -1.76014661664378, -3.16766770742082, -1.642893069234, -3.89131019448185, 1.07360226861404, -0.602936785422872, -0.221976163591339, -1.73211452433414, -2.95371164315041, -3.48272183895233, -0.294910420719764, -0.6437967737302, -0.0521930648170262, -2.53532523474662, -1.1251312686857, -1.93348117987752, -1.36565143114917, -0.215080459638246, 0.772035040974156, -2.17677462146924, -0.567392186966298, -0.685498517074474, 0.0883861142097772, -0.815072827912134, 2.55108043343459, -0.542024347791843, -1.04056489674974, -0.0687749399421621, 0.511240266573059, -1.0888873806884, 3.75821552210477, -0.987858535796404, -0.894240317395297, 0.416687601250848, -0.215865542479146, 0.627184255939466, 2.34032102623244, 1.08621499094229, -1.05943417433886, -1.10215779736394, 0.135615891340713, 0.549778768064363, 0.988280342022372, 0.239766760610171, 0.251587895266371, -0.0353168555995127, -0.111289533315344, -0.553880613111301, -0.64134019252613, -1.31854006637997, -0.772571248519175, 0.595532619463519, 1.04125805918522, -1.68825708117103, -1.04693310714421, -1.65221377337471, -1.46452575046807, 1.62627744805618, 0.539431265247283, -0.689795840763601, -1.96072436668048, -2.99943972973184, -1.37046406311974, 2.27253514002381, 0.837109331936593, -0.105973935780776, -2.91475568359172, -2.27894066839765, -1.63431008330311, 3.55850216844157, -1.83249436387619, -0.278091973527007, -2.67372314002286, -5.35846750054212, -3.06030642404836, 0.129270524233106, -3.48971841055892, 0.379136892055741, -3.09413288664329, -3.53481774840643, -3.04304673703038, -0.475966885122145, -2.24573019798917), .Dim = c(6, 20))
"tau_obs" <- 1.28934698883337
"tau_proc" <- 0.690180036336141
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(26365, 15989, 7487)
"mu" <- structure(c(-4.91662119579051, -4.89498767954543, -5.16400611086822, -4.96271357332892, -4.96633596168273, -5.23281294519296, -4.9695833860309, -2.29266513878716, -5.44924393931508, -5.44472105137434, -5.30953608154252, -5.94492830838808, -2.34107892646463, -4.32325117982561, -5.41884914118349, -2.95299167459188, -5.43903977337578, -5.35140394163088, -3.10614769052837, -3.41502651357605, -4.83870030028559, -2.5602965851815, -3.23422090251845, -2.27722783387229, -4.89114304865168, -2.60627709964083, -6.09520309914538, -1.2235606337283, -4.81758733529592, -1.44531003754227, -4.1771741546867, -0.681456251218087, -5.49540900233517, -2.98477501276037, -3.34730259852425, -0.0428562858384194, -3.36687139910336, -2.43366260343751, -4.49459545506579, -1.7771119219783, -3.32277421488996, 0.685028853267372, -1.05344023098045, -3.50415340223663, -1.82894889165634, -1.88594814182651, -2.0351309188986, 0.677556497357726, -0.329572035264122, -1.0239472614821, -1.52575486106391, -0.444213736974477, -2.78550794330288, 0.153655041529163, 0.442979513038072, -1.61216539159866, -2.29933147506797, -1.34018388880845, -1.6250582224298, 0.2222577423979, -0.863405526619692, 2.88552382159693, 0.0681179018112685, -1.34502428335066, -0.506178663298027, 1.17782454583616, -2.00669602799606, 2.88044033295609, -1.4034093075358, -0.499716264205762, -0.51958038230487, 0.260935554337282, 0.43446453100189, 2.9329080877769, 0.775960964075933, -1.36060132253644, -0.660824724177201, 1.96605540121347, 0.173293148118186, 1.80861810949543, 0.773320577735519, -1.80140207718016, 0.729446218951473, -0.864916416446195, -1.59625960385248, -1.22312752831759, -0.851551540156682, -0.790930353505428, 0.392808003850315, 0.412420251588796, -1.60317070301135, -1.27142107587341, -1.16222433577896, -0.331253084706383, 1.20442301671105, 0.569938089580472, -1.44589883840486, -1.04021516481283, -2.45015338656166, -1.12346007994603, 2.01640541401595, -0.0279438874612098, 0.0758777314466726, -3.70532468523211, -4.23209973654553, -0.460936677596677, 3.45426209220666, -2.79037560894174, 0.272462351580711, -3.55567859715741, -5.99139889022183, -3.98318665863542, -0.660996457969856, -2.71408137774084, -0.354870908899552, -2.83087246382159, -5.24176135400098, -3.66002660040006, -1.08883796652241, -2.39370179474075), .Dim = c(6, 20))
"tau_obs" <- 2.42984738029981
"tau_proc" <- 0.534201318280731
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1010224620, 1014310830)
"mu" <- structure(c(-5.16664340640007, -5.10273947716327, -4.97446267124851, -5.05468542318272, -4.93559560836385, -4.81879717850317, -4.68943575830334, -3.9007367492289, -5.1956232908902, -5.5558468943705, -4.66270007309059, -4.75959668928462, -3.72352669514373, -4.336199642715, -5.15491579018033, -2.61385849458512, -3.86756481164519, -5.34904796947467, -3.06400398502769, -3.82009849137582, -6.03458993418851, -1.27512426520251, -3.31193471227299, -2.84065596506928, -4.54444088640779, -1.83244130788514, -4.53698688208121, -1.87216547663606, -3.59829921687788, -1.69644565630001, -4.9018412277866, 0.05138976919055, -5.55616479162419, -3.61884696370477, -3.69097064271969, -0.838560896545758, -1.59852431827902, -2.10370393970986, -4.75761805067828, -2.00479489224753, -3.75627260857862, 0.359314191969646, -2.22801758427732, -2.64726459749467, -1.87112874964397, -1.12202530101425, -3.48382299279987, 0.657888843718015, -0.623982986357686, -1.50247623873738, -1.88562163153708, -1.06655433229717, -2.88995494751758, -0.595143717708786, 0.17253089588509, -1.28117313697163, -1.22132826956856, 0.327809847015586, -0.806768419585651, -1.26875702508422, -0.0156087339632346, 1.56259501516881, 0.222371350391279, -0.233071778663745, -0.482547239411905, -0.027654209364523, -1.41137605093242, 3.31809674703393, -0.635708043091275, 0.783293220927605, 0.155640715199405, 0.462308820503694, 0.396368246786076, 2.9041673292409, 1.79171593207673, -1.03208874858219, -0.385303123209126, 0.74923864735281, -1.26863955462254, 0.709790006371543, 0.978149453915024, -0.408882441897955, 0.870938004797051, -0.17521013857079, -0.904208208836327, 0.266184571795622, -0.250816919220892, -0.898132173039899, 0.838548062148134, 0.287516093461609, -1.67807456443023, -0.838171291074492, -1.00266921812965, -0.470352726987338, 1.48644514403305, -0.265930912918776, -1.99065047691644, -2.51247993219054, -3.56150443237564, -0.445332978177971, 1.65973759787721, 0.8340776877056, 0.912510209963109, -3.22815527135808, -4.34926050640107, -1.59907593598757, 2.08338255354852, -2.16025780848343, 0.528519742273224, -4.09907657323512, -5.6424002251741, -2.70957164860089, 0.199808812530131, -3.56407864160557, 0.346966672144409, -3.41106190945262, -5.03319530755453, -2.5868643338495, -0.276274936116354, -2.76579359818619), .Dim = c(6, 20))
"tau_obs" <- 1.6402273677057
"tau_proc" <- 0.649556129921827
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.03152707120764, -2.93529161218665, -5.62682143352007, -5.62682143352007, -5.62682143352007, -5.62682143352007, -4.53998150125268, -1.8829167632122, -4.53998150125268, -5.62682143352007, -5.62682143352007, -4.53998150125268, NA, -4.03152707120764, -5.62682143352007, -2.93529161218665, -5.62682143352007, -5.62682143352007, -3.24501396923639, -3.69607278418884, -5.62682143352007, -1.93052454973515, -3.69607278418884, -1.98051263011772, -4.03152707120764, -2.599159384297, -4.53998150125268, -0.667675378933285, -3.69607278418884, -1.46987021066156, -5.62682143352007, 0.65628623540281, -5.62682143352007, -4.53998150125268, -3.69607278418884, 0.28244132921539, -2.50826153633297, -2.69915335566306, -5.62682143352007, -1.17841886197356, -2.69915335566306, 1.31678063749515, -1.53336559479944, -2.81026845882755, -1.53336559479944, -2.14748345118878, -2.599159384297, -0.0647350929898851, -0.588172732416592, -0.709929869344222, -1.83747285085108, -1.24986261508958, -2.50826153633297, 0.54376846842893, -0.210732315329934, -2.20996889324303, -1.46987021066156, -0.695645735349935, -1.00962988892068, 0.26631272211576, -1.02923492550756, 2.75680497289931, -0.167994031729581, -0.381749577096813, -0.613977641063735, 0.535521302888246, -2.599159384297, 3.57823231161518, -1.75234744552965, 0.163663803379496, -0.832202726691689, -0.538478581733032, 1.18094709209741, 3.79206814586865, 1.41252002700771, -1.83747285085108, -0.600991952385723, 0.896523437913746, -0.0132565196671187, 1.55366459645601, 0.870206817285757, -1.27485833361738, 1.06844556692761, -1.17841886197356, -0.575515767064287, -0.695645735349935, 0.0559709878508895, -0.381749577096813, 0.462530338014032, 0.139347815767006, -1.32680601191085, -0.899444848892466, -0.769198629580437, -0.563017000255943, 1.43803122711501, -0.899444848892466, -2.27662053844541, -1.8829167632122, -2.81026845882755, -0.434948554174057, 2.24568255766146, 0.678064974235618, 1.5186538863447, -2.93529161218665, -4.03152707120764, -1.11174073279749, 4.40232012370812, -2.27662053844541, NA, -4.03152707120764, -5.62682143352007, -3.69607278418884, -0.769198629580437, -4.03152707120764, -0.273811209873728, -3.07820942207549, -5.62682143352007, -3.4453243315358, -1.43957306512941, -2.03313160883806), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
