######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-04-09 11:05:02 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the blended model to your observed data. 
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
mu[k,j]~dnorm(mu[k,j-1],tau_proc) 
}
#Loops through number of years and defines prior for each year
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
tau_obs ~ dgamma(a_obs, r_obs)
}
#monitor# tau_proc, tau_obs, mu

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(114, 44529809, -542091478, 1646738175, -614218864, 1101744708, -1208026223, -282341912, -116368844, 600106901, 1404961716, 214306215, 841897322, -1886392332, -569661244, 1568830278, 71982000, 724581303, -1885682171, 1923390234, -824168531, -323708272, -254259478, 644014558, 785513669, -1272121207, 1334696963, 86919811, -132501757, 620589216, 743418425, 1238923000, 317422100, -1289756055, -1299479267, 14140238, -1663416252, -1951009199, 1071044327, 156525193, 460476687, 136405824, 965080026, 2037235573, -582401553, 707430074, 981947132, 703002118, -1415859738, 516610295, -507067068, -502493503, 1690806578, -1393208377, 425274922, 54357877, -2120381179, -1176783145, -1647930426, -261306104, -144462718, -1278627187, -987727786, 802064727, 1443953389, 458587965, 2054510120, -779446579, -759678146, -1782825891, -2027044387, -1375663081, 486427865, -1682558769, 2142190504, 1411491848, 1913140284, -1506275341, 1086620182, -958103987, 186227928, -1928400986, 873539841, -672268875, 1194839454, 1834770646, -257337728, 1561150099, 1237788403, 1737550591, -22642822, -325225639, -470233371, 1021486228, 833805238, -1619631628, -840783492, 2121951704, 387877435, -2038788738, 20186867, 348524387, -1886647086, -621804506, -1019513082, 270820058, 534163729, -1635256664, 444734279, 897144365, 874019165, 152831545, 897148854, -1139661445, -19851851, 484725886, 435343618, 397524132, -1124275922, 80564938, 1965873686, 18284944, -1049903978, 745245375, -413156969, 982733904, -1237134578, 1463994546, 926551654, -845582418, -453761062, -1619426576, 1214046113, 1194292326, -603113110, 1720283368, -1387311134, -1795400216, -1068200915, -649335359, 956298835, -932107644, 296701751, -2004273858, -779917109, -548055058, 335316281, 1772829808, 1105646021, -16597142, 1162689403, -929477495, -522099968, -1490573189, 800357378, 1488287604, 1101979106, -1979733204, 1562253748, 932279766, 1344677793, -230552113, -730238175, -2074997528, 2041680510, -614682531, -85302105, 258867344, -467223494, -1514486530, -1084236047, 1806650876, -1325635719, -88548141, 1062646534, -1111868790, -200879338, 851772531, 1734121953, -1447015156, 1806079110, -465629793, 1763448049, 954935640, 633150422, -1092031546, 1214179964, 1023379326, -1617635610, -440930409, -1700654057, 12479626, -1409733963, 125381032, -1758602748, 1286382948, 47585158, -287357693, -1431601308, -977256872, -469458194, -1171677896, 1605930159, -1629901546, -1171312941, -1372151612, -1386713654, 1249747266, -1570749859, 1866661865, 1746672469, 2120776630, 1678366889, 1922942293, 953155176, -1737634688, 311440470, -1085759580, -1047998911, -1766943690, -269870076, 2107178848, 942305636, -330209749, -748778568, -1413156156, 501257164, -1460333083, -1936841967, -793314066, -1761131318, 1375699636, -16270816, -527496370, 506839418, 664894418, -704849862, 550118883, -237164480, -416597455, -1935001299, 1441987322, 129805407, 538373046, 1432149805, -601612749, 1251939117, 572379520, 2094957739, -1604737479, 1938290629, 845792350, 1768252449, 435491250, -1979260247, -826797494, 389709735, -1990245849, -1419959988, 1268881821, 1481687217, -156959913, -1159371419, -740139143, -1549129703, -393356419, -936742036, -1222207647, 1491064402, 1077333494, 2108035556, 1355063138, -2137132372, -1566283479, -1636661301, 284389458, 195522354, -100522813, -1089771802, 125170929, -692898878, 1051909881, -1778478268, 2096538109, 950084723, -1611342690, 1425930941, -62482941, -153798848, 641162867, -1860031544, 1486436276, 1962748662, 2058161086, -995389676, 74244562, -447537375, 1625415654, -515070182, 95336976, -2136304171, -1098109358, -967860692, 858887342, 162923967, 1314685672, -1213128718, -1459407308, 267903403, -261325228, -2034365053, 170319376, 686780135, 867260986, 377266641, 1256024590, -239745253, -1747236884, -672941075, -1287938702, 985052834, -387915284, 1136122070, 1489556606, -79774601, 1643828812, -2039253997, -642621464, 1049899490, 2033835411, -710644202, -820267061, -1735779618, -1551527073, -1927672110, -1139668610, -1967138383, -390236333, 508425910, 931569586, -1200567601, -1621641191, -118280908, 766142960, 810605500, -1590613891, 1320338103, 638778737, -1191211608, 687765624, -1093982433, -1473655151, -1655560127, -1493899446, -253852870, 545008058, 1945100849, -1602078966, -266406658, -1854075113, -2006087201, 837726949, -898305671, 628774534, 346080481, 885442482, 879780169, -926968028, -1543908217, 2105293884, 11369413, -1738918872, 428107162, 669338467, 509486703, -261314572, -1991730064, 70284063, 638854328, 1001422048, -6069004, 376455569, -126829976, 287513437, -341094110, -804883417, 278318713, 1163156390, -344574823, 1984652104, 450546336, 1194696714, -435181970, 767234978, 2120458738, 2012459420, -554838111, -672134891, 378520775, -905452227, -1495212758, -952929985, 1492709172, 881403007, 911572149, 301681362, 46356056, -1933297124, -1923177487, -1283725850, -2592889, 1503826665, 1378891415, 1485475398, -1556208200, -1218780668, 633924652, -1915361773, 1144079429, 1178253634, -1895102895, -1591742387, 947656542, -77890952, -660943787, 1303272344, 2130548683, 1283728228, -945814162, -1400594972, 881253577, 555321443, 783961566, -736039978, -1237885168, -1957694021, 1284943624, 2098642005, 1724045355, -827105388, 1230289643, -2083470234, -955850102, -879012682, -77987024, -1575007933, 2084386461, 817229705, 1758370901, 57250663, -1545353827, 836777012, -1000499784, 1079820094, 1467835982, 1126305609, 819319765, 587161537, 143111713, -1220386353, 1651865146, -1584521505, -695095347, -372588289, 1620596584, 1458123219, -1584678267, 841005959, 948597084, 1866014231, -1859168467, 2016241831, 1544527741, 116296715, -956624730, 1926050676, 1107241127, 780773269, 2063251022, 1934940805, 1763881136, 784257179, -773593561, 1090204815, -848328337, 1149882655, 1112555210, -1155074368, 1657266594, 1176902387, -1137321260, 714552011, -230136696, 196413046, 870428404, -2123460542, -2135461178, 904318338, -666845484, -1601542413, -476415132, -1390310741, -720570369, -422651261, 451913831, 1323041820, 1933481060, 811349788, 1038984147, 1587767360, -1233699800, -807824112, 1498310819, 1651878647, 602356469, -1904422996, -1553697669, -539084013, -949788422, -616551027, 1529636238, 1622385417, 763892695, 1848211259, -562769226, 510749947, -1533748028, -1600943393, 995448847, 617790522, -170111709, 723786098, -868228531, 917319194, 258916485, -1525675375, 224269280, -399815576, 472322157, -1464521446, -1895560901, 1825760147, 763222285, 1451447699, -674798525, -479900098, 245001623, -197321027, 1692929623, 1273096308, 942144649, -860889769, -1171077605, -339537835, 1578807955, -521305875, -450462243, 1152339627, 1221112419, 221233854, 324529759, 1023159412, -770137074, -287830040, -1240173629, -1229278437, -653617465, 1619540574, -1600242650, -665378503, -932765474, 355558528, 1348825307, 1415275695, 1426227375, 1192265787, 319325340, 958648750, 407193190, 1368688838, 14824251, 82767185, 1506769833, 873563825, -1750694118, -1350832620, 747258200, -1040574322, -103134327, -312122775, -1410480937, 727332247, -1392178988, -1053964119, -317532275, 591222767, 1306264125, -445220197, -160605027, -1101250045, 1679637557, -763835638, 143125558, -1954678536, 103810673, 1445656680, -2107342707, 2120769168, 1968944086, -1929981772, 450353056, -922837970, 505182900, -343660926, 839975888, -1120942675, -536759939, 712864769, 74216756, -885865121, -872392087, 693175936, 1209533241, -1399982538, 1336608130)
"mu" <- structure(c(-4.9054939896778, -4.90204211532473, -5.07445900740408, -5.02185633706763, -4.8601301692323, -4.98167297885726, -5.39711392660541, -3.54074981523097, -5.51934644921834, -4.52368338346004, -5.47812875985285, -5.27704232531394, -3.73887125619683, -2.9046514861127, -4.92761133224041, -3.1104918007634, -4.46434213731158, -4.25161399371951, -3.51022361654334, -3.01315486148879, -4.89960735543558, -3.04783171192127, -4.1868389771411, -2.75768543959666, -3.69108625859686, -2.10634069098984, -4.84404639390288, -1.9720326263661, -4.10705267911622, -1.01648870847246, -3.65455073239605, -0.254929093882367, -5.58845260602252, -2.30632562747326, -4.7634999466203, 0.281979065342071, -1.7677345783742, -2.41701430375018, -4.46908761966781, -2.91432447128109, -3.06395289459545, 0.210763789203556, -1.35004327674716, -1.75723349381418, -2.88802763311887, -2.27414976535409, -2.17915858560947, -1.10406205000383, -1.23290754353947, -1.16062963866854, -2.99416922436219, -1.67289230282918, -2.14617577923897, 0.774834195373997, -0.472205237669931, -0.515200451679331, -1.32962506007538, -1.30446744985095, 0.081341093570755, -0.353608997314416, -0.372457998819679, 1.8702422202486, -0.814557380061375, 0.655134741800625, -0.675040006072906, 1.00884263442266, -2.34688500957298, 1.94221055050527, -0.625963761124665, 0.52796387883538, -1.00017859480175, -0.420638934504321, -0.365468254860476, 2.05448301165663, -0.279451640358309, -0.380454079305301, -0.150325160582447, 0.572715212965156, -0.0141711088474982, 1.67527405009547, -0.00323177316135326, -1.0985492821247, 0.686260022353774, -0.15300875472908, -1.70688092131353, 0.848985831260405, 0.485369040608074, -0.590200744579671, 1.04361299280384, 0.758609813216101, -0.716183455736839, 0.227773270285379, -1.01831330148548, 0.129980659434215, 1.23897688162743, -0.0663292681555535, -0.154234654785102, -0.357831120868915, -3.57514902318797, -0.477392868088074, 2.24934234017005, -1.00888670257656, 1.49185920239642, -2.40253194017006, -4.46782849353584, -1.27956748929238, 2.94639471151248, -2.08450983933661, 0.816004877612043, -3.89349008922904, -5.30910614875893, -2.31367869534154, 0.415730346899617, -3.01949366141081, -0.773914148283252, -3.58576065673792, -5.74025987249089, -2.77401802363102, -0.544081546213277, -2.82412793006054), .Dim = c(6, 20))
"tau_obs" <- 1.16142355938558
"tau_proc" <- 0.78167619080827
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(2109, 14022, 5944)
"mu" <- structure(c(-4.93454805739436, -4.76463690752881, -5.08510552129102, -4.95194227374891, -4.84730168053011, -4.99659348391794, -4.80586657107779, -2.43368716782054, -5.49711107259222, -3.55710284692169, -4.60513536079613, -4.54998899095493, -5.00705982846783, -3.21672216916745, -6.05393871516526, -3.48519438934337, -4.98454796533779, -5.05890485352169, -3.85003174852985, -2.30406854902425, -4.79676468544288, -1.73014776069752, -3.93542362360142, -2.69670429479073, -3.93182301269799, -2.6944484335268, -5.11576825330343, -1.50688984229909, -5.17423900758558, -2.16378066565727, -3.99747143464987, -0.661587977114596, -4.42232331092664, -3.28451836873892, -4.84375542565804, -0.756394240138377, -2.5923970082312, -1.90698734112212, -4.31418089771235, -2.83221835348326, -3.15761668217718, 1.12242213235691, -1.05952459453411, -2.14435031409975, -2.59828826843664, -2.90029864757475, -1.83964024246013, 0.548714129108849, -1.16622548062056, -1.6921820426087, -2.13384215975471, -1.82600391479561, -3.15261512102567, -0.717244382916069, -0.693705613479285, -1.27145909035286, -0.295816602251939, -1.40618306646264, -1.22522157451416, 1.0076098844486, -1.47401131429063, 2.01744558640572, -1.39048310627132, -1.35052952446014, 0.0214468925548152, 1.3730087961149, -1.79874497297143, 1.66289468654973, -0.903361405932882, -0.0268042370751825, 0.0903352348679171, 0.492907247858836, 0.358343208732164, 2.10491477284474, 1.04923081452224, -0.582955135007085, -0.530291552135734, 0.646729090209965, -1.30818828847779, 1.03406699197971, 1.41714901507153, -1.38853201127241, 0.0955217153930921, 0.55939341865836, -0.72960109671109, -1.04526122995416, 0.0215163823639633, -0.539022921452037, 0.21743538992466, 1.15859067700431, -1.39636020898592, -1.32934054477896, -1.46423072434019, 0.13291331823921, 0.439817172997134, -0.889906204182614, -1.93812443506887, -3.18967211813799, -3.01306065624578, -0.829184760331249, 1.30827530467706, -1.51231170505716, -0.102426509831735, -4.06247229253916, -3.95659032465332, -0.95882600573996, 2.16754100054362, -2.14162525905455, -0.0558359894985552, -4.10706206908615, -5.52832101180921, -2.43502536288929, -1.1285793480592, -3.50157989792767, -0.342195300091973, -3.09316015311689, -6.61294366748637, -4.17969424313794, -0.188147433485516, -2.46309202426505), .Dim = c(6, 20))
"tau_obs" <- 1.29518681597864
"tau_proc" <- 0.721616016410106
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1027819625, 307435020)
"mu" <- structure(c(-5.04128845531848, -5.01195753622691, -5.07211827364519, -5.09419768615185, -4.9018824204434, -4.92296420800292, -4.41212259579941, -4.16662829149854, -4.03596033422846, -5.57547750914462, -4.92836417155116, -4.63869395376901, -4.10134099533909, -4.11383100775745, -5.48974313780232, -3.52402276040604, -4.96100007662668, -4.49725076309458, -3.55353895249061, -3.73073292187709, -6.09363886917073, -1.87523200537782, -4.07397484157481, -2.17221288319477, -3.77777495334566, -2.76051664761415, -5.34923288705224, -1.80728521465529, -4.0936364283701, -2.13484617937207, -4.84418154109281, -0.421160534986089, -5.69464998676843, -4.31356415414815, -3.83888048140289, -0.643442626280975, -2.85562320566083, -3.08075142630842, -5.2886852098092, -0.987965108148688, -2.43832182663655, 1.83077241160378, -2.00393434812844, -1.56034121346897, -3.06129412931567, -1.53687809539082, -1.55552946557872, 0.738350438166017, 0.324160067029251, 0.596011958231201, -2.9350214533419, -2.23001179470571, -2.18125717964722, 0.762957224052983, -0.753680674229592, 0.127540781225892, -2.44616806181835, -0.123375437767122, -0.635306692548625, 0.563446242404344, -1.57673712933012, 2.57610504758442, -1.52237860227052, -1.05957419616649, -1.27566521554786, 0.0902110346211633, -1.20525266607845, 3.29353216807866, -1.90089729591071, -1.42280358623318, -0.169750133178303, 1.13821734126971, 0.262594172939543, 4.24545626347864, 0.667364447862892, -1.61924932870514, -1.36176119338941, 0.571669381517957, 0.494296651282815, 1.06021094677384, 0.973500209239606, -0.515067511353465, 0.713914870032663, -0.240707182534362, -0.59891318428863, -0.878033133448346, -0.4438967497707, -0.915628656224687, 1.19827825589334, 0.265656290497455, -1.84718344703764, -1.46747327398811, -1.24783477651355, -0.182692099879697, 1.83038978386094, -1.71434754691899, -1.40138823223776, -1.11731315357927, -2.16777775018001, -1.79280587344533, 2.18559094477099, -0.837796849126099, 1.51492134460848, -1.44021620831468, -2.88976634648043, -2.54745914323737, 3.02981252915308, -1.81980142196249, 0.551949661655698, -2.56702975792794, -3.72402471282879, -3.35827035413423, 0.984620853524796, -4.36131478879089, -0.516248801655086, -2.79599978817454, -5.09552595956886, -4.01096813678253, -0.093266836618535, -2.11167320980839), .Dim = c(6, 20))
"tau_obs" <- 1.26229600277431
"tau_proc" <- 0.538965397673832
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.03985637693803, -2.92620621090538, -5.62682143352007, -5.62682143352007, -5.62682143352007, -5.62682143352007, -4.54690127786412, -1.87993516013178, -4.54690127786412, -5.62682143352007, -5.62682143352007, -4.54690127786412, NA, -4.03985637693803, -5.62682143352007, -2.92620621090538, -5.62682143352007, -5.62682143352007, -3.25450300251135, -3.70500883604382, -5.62682143352007, -1.93378396925747, -3.70500883604382, -1.98340435348289, -4.03985637693803, -2.59561477177242, -4.54690127786412, -0.668259465052166, -3.70500883604382, -1.47141661453673, -5.62682143352007, 0.656275705784041, -5.62682143352007, -4.54690127786412, -3.70500883604382, 0.282619278109319, -2.50592601701208, -2.69414729593322, -5.62682143352007, -1.17895504135065, -2.69414729593322, 1.31683709610467, -1.5343304399473, -2.80346038590687, -1.5343304399473, -2.14900600506575, -2.59561477177242, -0.0644318601593888, -0.587706668101948, -0.710089901290257, -1.83508459396643, -1.24966776358807, -2.50592601701208, 0.543834777372936, -0.211214980448936, -2.21091790446822, -1.47141661453673, -0.69595110789268, -1.00895441673757, 0.266662705227706, -1.02834023568278, 2.75681496812374, -0.167708844426109, -0.38184624250953, -0.613227557384072, 0.535674321735381, -2.59561477177242, 3.57824393896632, -1.75100147675589, 0.163478468992475, -0.833329211159808, -0.538539462333506, 1.18099072793401, 3.79205859229696, 1.41259543553926, -1.83508459396643, -0.600385700478634, 0.896332892533209, -0.0134905901824991, 1.55362917560552, 0.870288677312358, -1.27439526862248, 1.06835924549709, -1.17895504135065, -0.57518638292638, -0.69595110789268, 0.0560021901152849, -0.38184624250953, 0.462223441926773, 0.139414055782678, -1.32576386137986, -0.899925377787891, -0.76873316751654, -0.562820918884371, 1.43808003426912, -0.899925377787891, -2.27691734624547, -1.87993516013178, -2.80346038590687, -0.434482057178657, 2.2456548884065, 0.677830476448052, 1.51854994024036, -2.92620621090538, -4.03985637693803, -1.11291407337897, 4.4023144383706, -2.27691734624547, NA, -4.03985637693803, -5.62682143352007, -3.70500883604382, -0.76873316751654, -4.03985637693803, -0.273647683487978, -3.0878475624618, -5.62682143352007, -3.45459815838927, -1.44138432743785, -2.03561606213981), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 0.001
"r_obs" <- 0.001


}

######################################################################################################
######################################################################################################
