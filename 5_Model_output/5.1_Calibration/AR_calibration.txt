######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-04-20 12:27:35 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(1402132345, 569201021)
"beta1" <- -0.282532889316234
"beta2" <- 0.73280908122966
"mu" <- structure(c(-4.79163429989046, -4.86090232249905, -4.96772513841293, -4.94582096395847, -4.99442430676875, -5.07292570276393, -3.48080763377823, -1.53342332594796, -4.59966278589916, -4.5343466966948, -3.92993617204861, -4.29051945948208, -3.24858925445174, -3.26989883707844, -5.32008373795642, -2.82010764424981, -4.01629936111032, -3.91723517920494, -3.28591356925533, -2.9991382684632, -5.55855726486108, -2.19970646693472, -3.55478655605563, -1.57172226290874, -3.71905749731756, -2.07663658794026, -4.92116446531944, -1.07347321751943, -3.50360081145595, -1.48905552074507, -3.78146444979857, -0.213057849808221, -4.86127966264994, -4.24477873268993, -3.26621864424131, 0.651208246517999, -2.213975331656, -2.65204160503388, -3.98832217758371, -1.99195800829908, -3.1504169007633, 1.04130029446052, -1.77505524181767, -2.58571714351867, -1.92729218979316, -1.89653412144476, -2.59481261230829, 0.953122287020031, -0.962852842865644, -0.636063838718082, -2.76272276028032, -2.2807930209637, -2.02948648358768, 0.706074083353421, -1.90035795289636, -1.40731756447122, -1.59587366813987, -0.318036212974533, -1.6578172364201, 1.02572655967674, -1.41912250961395, 2.79277383263749, -0.868780167002096, -0.000347812192556807, -0.552819865699339, 0.916435817797329, -2.11279506458407, 2.57921596535419, -1.99705061888398, 0.380323775947464, -0.601255102095992, 0.605894401486952, 1.53969862178926, 2.6717709929051, 1.03573630283821, -0.711203016784959, -0.327497198263166, -0.62544392877354, -0.780800858740597, 0.724045359233278, 0.973563654469031, -0.371417476765214, -0.287914313932212, -0.565307297187156, 0.260909554043448, 0.167647352190318, 0.199128459125058, -0.756220222708302, 0.160894668644893, -0.462541320616315, -1.26110134198661, -0.388716262487307, -1.14518158293058, -0.00665395682992176, 1.35278633656478, -0.890369097093825, -2.04833579476711, -2.4718253104364, -2.21798150316986, -0.547160001590623, 1.66660453166024, -0.0315336127058332, 0.985615617363176, -2.76562843463945, -3.55868492984853, -1.01935775519238, 3.2847394865828, -1.35798152855374, -0.173960185998063, -3.94565454580239, -4.57470452324528, -2.93549502970029, -0.254806860450363, -3.23867551351327, -0.69918394112814, -2.10257547515063, -5.37529944952651, -3.51578615950983, -1.17675455564882, -3.48788728500832), .Dim = c(6, 20))
"tau_obs" <- 3.04769117468751
"tau_proc" <- 0.589727943972594
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(113, -954826986, 244196137, -1390248721, 365897082, -1066788097, 1916819511, -1095434969, -1939852655, -1567310666, -1436254332, 1188268420, 1296642359, -237598714, -1627308479, -1825564292, -220738960, -1581975541, -88147944, -352501932, 338520870, 2128695989, -1732798941, 1995383903, 1321268674, -1033149501, -1758713634, -659254329, -1377361412, 440035835, -1322220513, -1987767232, 1886873579, -1328809490, 859279511, -1590031022, -983177685, 1866963872, -1568028987, -1929371074, -78042526, 1705311652, -1875934262, -443523894, 944498569, 1317141896, 524673461, -498281436, -664984807, -361624082, 396612633, -2081124007, -347835803, 59612350, -1436756849, 441503632, -1834388950, 1573605849, 1155660186, 1161188947, 465680521, 2024101610, -338933251, 1019093820, -425802799, -169993839, 377027695, -1003280860, -1680584071, 30306784, -348843680, 1870022084, -804218969, -2050899119, -1619010124, -798905781, 660238750, -995165382, -1670236049, 1924378310, 1915249080, -2100284431, 530670296, -824258210, 960495715, 1595843806, -849845974, -672964512, 1666479005, -1862875258, 232392521, 2139161298, -1959810720, 432239615, -1318252497, 31988143, -484493407, 849475036, -396795112, -2024611333, 937032519, 1475306735, 445123118, -530575259, -1105208108, -2142802553, 562965209, -887981274, 45947655, 1715858335, -1341085954, -239867929, -1675971329, -339461695, 263432679, -728714013, -373978467, -1598617830, -1559399999, -355123291, 22130428, 304996868, -1753005619, -1129290310, 493528449, -2079743958, 1543031197, 1715399282, -1175291145, 1592707508, -1908642993, 1910310447, -575540306, 291769590, -246246333, -459596895, -661259384, -99148377, 575632851, 1980333172, -212435498, 489221495, 796760459, -95556853, -1669674405, 889111994, 642316665, 1433974113, -1771107144, -296219687, 2062731524, 456107965, 350984848, 884732260, 1152335515, -257311808, -277434719, 1778030911, -1065484068, 1939251569, -1325920905, -1556588704, 82995357, -1089081276, 1082758894, 696626605, 635302244, -778735724, 509353133, -861109055, -1175367295, -728945197, 1630250617, -2081435195, -1256822085, -1344357642, 644996400, 315023208, -1212915220, 492853176, -1355118648, 541315676, 456406360, 372311716, -975171264, 349868745, -577848630, 110619504, 616355285, 201932038, -531516932, 2127332128, -1125132520, 1750966450, 716544066, -1075599725, 635794261, -959119533, -244935406, 1578743035, 895110623, -178663446, -2043089011, -2126215395, 1925678468, -1106183623, -789928009, 1308179401, -629106360, 1245014417, -1620577427, 1635977575, 577164009, 263552601, -1285135815, 812657013, -351646848, 1890874134, -727098989, -926234645, -2054551826, -1614994462, -115574448, 1495085801, -1653105203, -653607592, -1804508335, -1594303269, -855318838, -1488384506, -1951951893, 1856789216, 1404047055, -905489227, -1789692462, -1496857458, -545263731, -1377320923, 1924266536, -1714839503, 1235087065, -765461230, 456825498, 1079678480, 1664240924, 1696220324, -1472907542, -1537724942, 1445967317, -403165617, -357352199, 1946310299, -1084467020, 1935328026, -441807950, 1175832851, -108222860, 1951654165, -1907097831, 1261292736, 1307202804, -1942369229, -1145892000, 1353169797, 888730274, 1351394995, -1052503501, -1168256303, 1874225710, 399889837, 1637843394, 1143974997, 1789527856, 1207922212, 1816479542, 1996669237, -989434933, 557859213, -233271281, -1837735283, 884376239, 1396105335, 1796564942, 1304046745, 1315490779, 359968897, 1616878704, 298756973, -1642925620, 1528878345, 2053297808, -2017255256, 615230134, 835755108, 583682948, -963657176, 522048867, -2080128701, -2112559654, -723169927, -942075242, 595239187, 1762484283, 1674183388, 111631220, 551181842, 1941616403, 1812268081, -419926030, 1462357532, 1536733416, -2144955217, 86493161, 430636795, -34352260, -809450169, 591869827, 1792420790, 227980237, 489588530, -464554571, 681646779, 1040643191, 957560704, 1298572510, 1007401925, -1059537215, 1467306887, 1459003090, -310278208, 1419400561, -924983576, 326515224, 1981982842, -1799018544, -1096689773, 1128557537, 584657599, 1621057920, -668693421, -87628673, -260409970, 1252838239, -358081176, 442371734, 1301955790, 37611177, 197590287, 823612380, -22003003, -498642293, 615361291, 542777918, 549686852, 339954496, -1087720347, 1669420730, 1317086825, 615387311, 1260734034, -545946913, 722626314, 357911215, 1545338289, -1070919337, -743649227, -60850888, 1920472185, -459319664, -954110275, -1814154541, 1281827179, 1881605206, 679570237, 571701425, -60176544, -642963875, -694456112, -2104639258, -1182927488, 1713353915, -1363974325, -66499219, 1351870424, 901215639, 1865393044, -243542115, -1100502833, 2036440171, 1871730388, -1198875989, 2073826107, -1067801689, 1685287178, -633665275, 1481278036, -639138167, 402358281, 1386239034, 1564944936, 518427165, -794163781, 464234276, -1933951495, 756601863, -2132649498, 749647419, 1470162873, 2031662868, 903263233, -1189422503, 1848249828, -453268419, -92939088, -1156008390, -500694039, -782774399, -2053956496, 708836122, -1572437259, 711995806, 1383636190, -259902617, 1416435446, 1420097694, 617172187, -1914938687, 878049017, -448447813, 1819325632, -812534158, -609342781, 868995770, -527217402, -512421975, 1588407105, -1639503559, 296657282, -1150749740, -1166572143, 416284294, 659941820, 452899007, 2097006375, -1919956915, -1225005933, 1196200276, -1321838617, -1289196077, 115267876, -348170896, 502308312, 427155698, -1979573740, 221606512, 1651124530, 233286926, -437185925, 2012903234, -423114989, 1590412139, 140939337, 1569304391, -2022976690, -728004875, -1375741267, -1096404413, -716612095, -705178439, 147505039, -1079016585, 1033144701, -1010259212, -157568847, 494683933, 446973185, -888583520, -740362937, 140118437, -1503629392, 1576884951, 209893436, -2021938653, -2108075001, -3397735, -1872029206, -1740860897, -2108681895, -578861274, 121659715, -11825565, 211244299, 221305035, -1055354783, -1113915348, 940594681, 1599337948, -842059181, 350137185, -1465913265, 1397413928, -45074802, 846732483, 1133813379, 1854239303, -664358104, 209154242, 1614882197, 1159771857, 1210919325, -1263153234, -1469628937, 979838237, -1441013331, -1384962165, 201281264, 1201912941, -1755010984, -250460515, -2061442240, -860724451, 1469118425, -1584721983, -459317986, -1166599200, 615501847, 404460059, -1722182375, 1386215633, 1519879956, -1751872401, 2091087068, 2125652749, -657320959, 654988292, 1671879593, -1898657963, 729531650, 364590844, 738086749, -742737275, -1381411488, -999242165, 6106789, -1999116305, -337338133, -1705141178, 597747553, 1240782974, 974325014, 1935184088, 744210788, -2141488105, 1714365838, -1491869194, 336752962, 61641345, -1699085033, -1703360891, -1987948812, 140669809, -675105526, 973724370, -811907306, -1207564074, -1452460334, -465712318, 1696030107, -1529748702, -246282353, 651642149, 1587918492, 1724512925, -655576346, 1475459808, 252683889, 721070268, -343448079, 1331681357, 1891672166, -1772432683, 1151019653, 1454998573, -845773356, 215363568, -107096451, -326046397, 665766540, 1983317099, 1135154586, 455851642, 1355809966, -1893445405, -295437979, 761085424, -576393705, 609038020, -1525025460, -1705666545, -456380105, -368817605, 573505811, 867360632, -368587619, 308402306, -1012447414, -1660099241, 1114695774, 1186386672, 1655772087, -490189628, 1359654537, -694783603, 382072839, 1400543654, -1676952886, 1489341433, -1828229700, 660579839, 2046790032, -474167175, -1813240329, -84327065, -1813388764, 879804290)
"beta1" <- -0.147841137684478
"beta2" <- 0.716250204110799
"mu" <- structure(c(-4.81526436103564, -4.84303512258638, -5.09401620627456, -4.97585290914677, -4.86083884603039, -4.97047580487053, -5.27092469672936, -2.56525916001346, -4.96766292005022, -4.01337655183406, -4.6279015910569, -3.59845970177593, -3.79359815415239, -3.71918998229953, -4.97118541486893, -2.76772539089279, -4.93383750073036, -3.44892190917895, -2.4977356587132, -3.20873710730209, -4.37040516461945, -1.59865126109037, -2.71247630619979, -1.48864608054973, -3.31360219306347, -2.73805569429791, -3.77365625144518, -1.35657684638338, -4.98247965891636, -1.86111929945598, -3.8192371742609, 0.441419339829132, -4.92986647358222, -2.58284642271892, -2.90397568484062, 0.263877959476792, -1.9678866562791, -1.91684290105435, -3.17470179605012, -1.06689411491979, -3.5611072726506, 0.660922353755167, -0.933466192970607, -2.58213267613209, -1.09217051394895, -2.14673901536836, -3.67776132818024, -0.561839822087587, -0.500878135533177, -0.606293429334438, -2.66157997144568, -1.95136555065711, -1.80577273641709, 1.01860348841061, -0.680466943169804, -0.600339427994398, -1.15389620945637, -1.21459402622456, -2.26810343466396, 0.35345081337729, -0.310524117446951, 2.17623521019121, -0.150016899381737, 0.69810218313202, -0.676391106897738, 0.151197307432354, -1.44608871307457, 2.96847238940078, -0.175914704792861, 0.190130955951962, -0.798324755336711, 0.239354736038651, 0.419934324022915, 2.94099533868036, 0.595172705324579, -1.80723744002661, 0.409459844926619, 0.787952007085174, -0.515006086847544, 1.25333760245398, 0.80235188263404, -0.666652005476224, 0.985049417041966, -1.3495196029678, -0.774928558564101, -0.327738992544717, -0.262518034565213, 0.282151849629556, 0.0976757626084314, 0.427732193438354, -1.1556889694495, -1.85963547681537, -0.303677430292448, -0.0593218425018534, 1.86671145360424, -0.836579815672933, -1.20719331651892, -1.95640577525883, -1.27455919155029, 0.609415079851425, 2.45387909836278, -0.990446994453665, 0.397083058996588, -2.78222232543751, -5.0196631800842, 0.442643702350763, 3.1928780837664, -1.81961065535761, 0.335977520941463, -3.48442138343582, -4.90676559605281, -2.09137544789283, 0.605554200014439, -2.50365331565768, 0.114210984658516, -3.12111535099098, -4.17036597746637, -2.45474298587934, -1.30370185573166, -1.1965010379316), .Dim = c(6, 20))
"tau_obs" <- 1.74981910459692
"tau_proc" <- 0.725714713782794
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(5643, 24796, 19252)
"beta1" <- -0.347343178441125
"beta2" <- 0.687112054129404
"mu" <- structure(c(-4.91478786958265, -4.99600228255632, -5.05375303079725, -4.91783719291612, -4.94479652002599, -4.88673840750815, -4.95207166594425, -2.43176573179318, -4.50153077800661, -4.86924741062648, -5.31390373149086, -3.9666980124089, -4.97312600575379, -3.90255601066593, -4.99100609307732, -3.35337312503202, -4.39692260308398, -3.59988005438461, -3.07463165982849, -3.24598698693442, -4.67828734311675, -2.11045950838711, -3.92436209479917, -2.55064923572232, -4.1416778088684, -2.24032270107166, -4.1187821209035, -1.14073015363151, -3.54620736774203, -0.48606496579373, -4.23224362878964, -0.326137923285855, -4.88446013034837, -2.91210627243028, -3.93180874219914, 0.998757871335727, -2.96649887122067, -3.1077553738975, -6.26113513455112, -1.16272628301489, -2.1891327876826, 0.408902109436083, -1.64869295617721, -1.68242519597779, -1.77735018664194, -1.86100660745002, -3.71836577422699, 0.0689940777276862, -1.16499138073373, -1.30625229134715, -1.31613348249012, -0.863272863527921, -1.5353628164313, 0.963942440116736, -0.971406560482935, -1.79278925814908, -1.93903049053494, -0.673925812571793, -1.01361318256385, 0.700523919502199, -1.02529027199693, 2.26274688069868, 0.38226753189751, 0.49998477843844, -1.3559158614875, 0.695280821565791, -1.51834793615336, 3.64523791344179, -0.878415964108522, -0.208160032034012, -0.962968740458884, -1.46223517632694, 0.873495124434417, 2.41614247497019, 1.56353500550695, -1.05062620880527, -1.10966863254556, 0.533663984728261, -0.819493522487141, 0.858451599655127, 1.102168971481, -1.5254740564523, 0.234214078287123, -0.557322666541607, -1.35136029007693, -0.732244421559549, 0.866444090681102, -0.618393543275945, -0.0483507087761281, -0.0190055389695368, -1.38168107436295, 0.0144298957576686, -1.21142140096005, 0.0317860037412218, 2.00879340056916, -0.860657599732391, -1.53166380428684, -1.57136169734266, -2.98324543998316, -0.273125652744618, 3.4036016587373, -0.660551690524084, -0.582924759937507, -2.97686681444589, -3.15386375098206, -2.07365787172241, 2.90795889338901, -3.32487856711787, -0.164898018988206, -4.23347269803894, -3.69198953841548, -2.40679861033758, -1.720324248622, -3.67824871911102, 0.35011815389974, -3.42203297976993, -3.77389949910908, -2.37514243774658, -1.92667726141727, -1.73759980768749), .Dim = c(6, 20))
"tau_obs" <- 2.25497304110201
"tau_proc" <- 0.726514610834571
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-3.85980369014249, -2.86343927118061, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.26355862228935, -1.85743696973239, -4.26355862228935, -4.95159275346247, -4.95159275346247, -4.26355862228935, NA, -3.85980369014249, -4.95159275346247, -2.86343927118061, -4.95159275346247, -4.95159275346247, -3.1683696152567, -3.57297780368645, -4.95159275346247, -1.910055720008, -3.57297780368645, -1.9584839181152, -3.85980369014249, -2.55012206191651, -4.26355862228935, -0.661508725238449, -3.57297780368645, -1.45640727768747, -4.95159275346247, 0.658075359447239, -4.95159275346247, -4.26355862228935, -3.57297780368645, 0.285233178195202, -2.46425572610276, -2.64405992074449, -4.95159275346247, -1.16773044583689, -2.64405992074449, 1.31776713186147, -1.51835421625552, -2.74774570870643, -1.51835421625552, -2.11966258526556, -2.55012206191651, -0.0607354836898151, -0.581476769814426, -0.703051798172265, -1.81356262524385, -1.23762564284707, -2.46425572610276, 0.545848385406104, -0.206935445467576, -2.17972929416229, -1.45640727768747, -0.689011472830919, -0.999476338867932, 0.269318592960969, -1.0186775184919, 2.75703540249097, -0.163611130691224, -0.376772502579018, -0.606837133839059, 0.537704412220319, -2.55012206191651, 3.57834089259093, -1.731198082625, 0.166422615608164, -0.825371688593113, -0.532607577803059, 1.18205601731843, 3.79213688288921, 1.41344057964001, -1.81356262524385, -0.594076560473089, 0.897748741042104, -0.00997747407868495, 1.55436319024868, 0.871741857734603, -1.26205351705275, 1.06955146236881, -1.16773044583689, -0.569033760516405, -0.689011472830919, 0.0592798458080164, -0.376772502579018, 0.464408088230409, 0.142429802890188, -1.31277577255996, -0.891422193820534, -0.761271566892886, -0.556743678768707, 1.43890392109862, -0.891422193820534, -2.24363589004942, -1.85743696973239, -2.74774570870643, -0.429134835254822, 2.24602237489292, 0.679591787844505, 1.5193101505469, -2.86343927118061, -3.85980369014249, -1.1024030572059, 4.40235696751028, -2.24363589004942, NA, -3.85980369014249, -4.95159275346247, -3.57297780368645, -0.761271566892886, -3.85980369014249, -0.269093075706006, -3.01446390455736, -4.95159275346247, -3.3503483160569, -1.42681583503013, -2.00937729712331), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
