######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-04-09 11:07:01 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(478, -1980594486, -781376178, -1779271506, -2024378122, -425628877, -1246090557, 1299244008, -307277765, -1499978059, 1035263808, -81849314, 968536284, 1647122609, -1422194156, -1543295143, 1973986280, 274574555, -865626950, -858155010, -1740391367, -586978232, 233126010, -1655258421, 1514166288, -192432290, 437634627, -1163990616, -1692655949, 561215398, 1315788261, 354241014, -1161079480, 735530706, -1278250542, 1386673430, 1592536286, -1972880934, -1432650946, -1369751588, -341337066, -1112603199, -2053425160, 1578939048, 1632183436, -1008505610, 1202458567, -2004527452, 1060819845, 1495270382, 1106721563, -1500438497, 282401594, -1326035777, 818353646, -1580355344, 1897904798, 537500042, -1472923561, 1894284217, -723195191, 512838408, -1999286733, 1732978861, 114098634, 551909442, -417845767, 1411952540, 256814518, 252190037, 536736189, 40823981, -1742184662, -916675017, 1264951230, -1017567943, 1518461216, -1820455579, -29511016, 1442555953, -727925664, -2132026333, -27418044, 1372374764, -1717800713, -1097699633, -1271113326, -1513641739, 1247601272, -569395146, -588820510, -1583765500, 1052539046, 1849627508, 1286945370, 338982946, 191010156, -1456048685, -748693967, -2112836338, 2100630501, -1876041460, 1255101719, 715264745, -1119098186, 732366806, -714135744, -28411704, 1551295903, 2007323793, 1158218606, 1419105113, -1079671706, 1382367629, -536303439, 804744811, 754302977, -122859158, -961274314, 1274117320, -478674949, -1988101139, 1770705280, 51427604, -2048565170, -299378250, -53483323, 108749315, 1197250318, 309403628, -1911316725, -1958661396, 1698601366, -1464375241, -1741391355, -1436138007, -739853120, -800759110, -885308609, 192839869, 1498333816, -1513901389, 976612999, 1508181630, 1740739613, -180066536, -458346506, 1856984372, -1962423425, 1808132062, -1781746972, 1211417163, -898548761, -1847682943, -574415230, 1415714212, 1212530495, 1009776374, -1115343545, -396823791, -1267525145, 9736975, -1326368616, -1188546053, 363142684, 1222394016, 393684543, -473609420, -957590526, 1875272176, 1592611476, 1883658641, 2118999246, -1627648546, 365321105, -709214584, 1140046803, 1831507836, 521181553, -104993668, 371406823, 343031385, 131197152, 1765209068, -860057684, 824900433, -1789215799, 2077301183, -676359568, -926262220, 1486614599, -447212224, 1812682567, -478365378, 682025406, -1123724398, 1776874699, 272762978, 1367768588, -1882147050, -1961802861, -1749910998, 667565384, 1965681298, 2041156007, -165214222, -260646976, -1733451422, 1049761593, -2045317717, -564573137, 1230357218, -405617599, -1091126405, 1620678743, 1459749813, 1155405395, -1730152364, -208500973, 906324864, 674486858, -831365841, 1907507059, 729328401, -1151276477, -2134532759, 1813136458, -1493362541, 285610646, 1739130190, 1325167274, 2119884167, -1074610679, 1776913967, 491807750, 1690430700, -1659534742, -1324184853, 373173571, 491615298, -1646677615, -166636946, -1574840575, 2040867245, -419209458, 1284921075, -945573495, 1484461072, -1305518327, -1855608850, -554280031, -427970048, -553005463, 974680180, -546900954, -170150618, 871732927, -567752263, 1885729506, 1057160278, 1960139980, -1404661883, -1502441833, -979642705, -1525804597, 1556848742, -852122796, -76082049, -337437716, 738510162, 513646107, -1038430030, -1391881909, 1075908379, -994764529, -1658227659, -185115623, -247704600, 549279258, -358500276, 1644732526, -1372687051, 500624687, 93680204, -278747710, 77224742, 1894652498, -677305305, -1788262406, -1118522767, 1289142163, -1880298543, -19410335, 914626786, 346546383, 68032599, -703019624, 1563277834, 302061456, -1313991528, 1534106119, 1955508889, 2141730825, 1746014259, 504402228, -1247182954, 1732577439, 2136982009, -1289883995, -643920021, -427704414, 839969473, 625797715, -395120871, 2094887764, 350042550, 1309833187, -1177907462, 1553602707, -1629279748, -2032280521, 1731056235, 2004123723, -1326342364, 1465526659, -398501224, -146677694, -37009382, 1931257065, -1004734627, 90382891, 852885196, -950210560, 37019423, 600957284, 62531950, 1231126089, -1671589024, 1405596287, 641601325, 935259338, -1536205342, 1579857579, 77484638, -1906769421, 441728789, -881770077, -2098419455, -1080791206, 227792397, 1862386803, 661490781, 228228230, 105570408, 1699449077, 1588687460, 516534120, -639120389, -1260154277, -600258029, 135156232, -869368921, -1490147685, 817407340, 1814202556, 1665429310, -17215295, 1689911033, 2139095523, -1959698688, -1515758397, -620809522, -325657877, 1732925145, -1455328161, 78800470, -986443872, -1632099225, 634208146, -636083242, 1940619416, 594171208, 1081661795, -1531878823, 2092988370, 1463023159, 454503953, 1284042068, 1126244855, 350812491, 322692033, -376320872, -516213508, 1878782691, -506111206, 1747473698, 1154821321, -495978857, -1778819726, -2035740428, 476080939, -953470103, 939872477, -737521875, 150753837, 1737683024, -2069155647, -827264537, 754396163, 1911852158, 1920829090, 1122863043, -1886937424, -112465384, -588105178, -2013678558, -2031964898, -1656337051, -1079916784, 577742845, 1677710489, -1147951635, 155387969, -2142708353, 941235178, 218333867, -1258443326, 1491483855, -11451715, -439296225, -852725467, 1770600305, 1988438552, 1547496637, -2022015797, 1398167745, -149452211, -1454833975, -1753767218, 1371108526, 1807464238, 400642208, 1900818240, 489658357, 986808267, -238380185, -2126698366, -2090951190, 951740384, -2015105277, 350053636, -2020097243, 1769697563, -147656460, -1501781547, 274364688, -2059923591, -1110328029, 1913520773, 2117736082, -20850522, 498157369, -655147691, -806100376, -1170843784, -2132650269, -678163114, 1888379832, 62679742, 1583558762, -829225389, 1824581559, -761854227, -871694244, -1531618737, 53371582, -2086691588, 548491034, 1321355740, 1695576421, -495618423, 125018984, -116580674, -557651658, 554386136, -878426890, -1492676020, 649377992, 2145642993, 1716655781, 250216264, 370733929, 99088548, -1231231807, 1343906681, 123250213, -1286546853, -1817766936, -786457683, -1722419619, -1036704919, -1830035131, -988069362, -346141546, -614978512, -1141576106, 1787466520, -2010695720, -929599408, -1135886442, 229726245, -236434877, 1684676866, -495343168, -2014636487, 1315037039, -2104567334, 391583664, -193128302, 2006126264, -851703332, 194605934, -579023642, -918415881, 1369936011, -1886086267, -1898636858, -1481691525, 1155612885, -1236506540, -1146783445, 189543317, -879271405, -1128333997, -1202600884, -1760591075, 1501326903, -1161287296, 304034674, -1311568576, 899445542, 1126932514, 306964738, 199915930, 21456058, -901253835, -516391522, -313733520, 770318974, -264266313, -1258106892, -1394744265, 63924084, -1548271725, 237043014, 1693836280, 714712643, 39356923, -1727019332, -1793435198, -1821415397, 1901613328, 730871881, -1557016829, 1152941092, -2003425276, 1348098755, -1348372193, 1235690005, 97272583, 724253429, -68449469, 1049365055, 1195472230, -1487646313, -510528147, -649820638, -1485456135, -1683590292, -1232389390, 1274530627, 1581203913, 618427766, 1597380617, 2079687574, -1561789219, -1664931642, -1689384616, -586631941, -684632402, 970820007, 1574325472, -1203952509, 1254879452, -304126777, -2124287521, -1292843432, -536723525, 1002474247, 1276448622, -225682007, -1598967746, 699340395, 807994643, 195055357, -2102107730, 327083191, -1877679329, -1831757175, 865747432, 561732862, 1233247172, 93503053, -400174843, 984603403, 261429852, 1224065936, 345845068, -1202163645, -1869865519, 794389856, 64887906, -1682962487, -2118270391, -1500072462)
"beta1" <- -0.0649378191396627
"beta2" <- 0.857350143064113
"mu" <- structure(c(-5.11858537584364, -4.86238425500725, -5.03814931979857, -5.24639829403446, -4.99583603863107, -5.00097468378198, -5.21270890839291, -3.58808534831451, -5.07814627007475, -4.38101635758287, -4.40083962889171, -5.53529678762758, -4.98081247504826, -3.61531231868273, -6.17693357068026, -2.47554629654649, -4.67529537100479, -5.01107012624982, -3.18993153221838, -2.50488499126727, -5.96462621039065, -1.83974127689265, -3.44877244525833, -2.35975702277718, -5.12194732412552, -3.07043222429504, -4.70527030937866, -1.75438043452726, -3.78203936942234, -0.580457656157293, -5.25823985085308, -1.77766419180594, -3.36894753333856, -1.68620766748499, -3.23745079211275, 0.573753294304194, -2.88146266220239, -1.6476231372729, -2.45889291988641, -1.43661440165756, -3.78090964403873, -0.0667761549341044, -0.679601464294612, -2.24437348806543, -1.61684738564264, -0.977136604684901, -3.01852838153109, 0.587804760924197, -0.317811127863432, -0.845923064802225, -1.65083607389276, -0.886246692826111, -2.30449199995678, 1.06046618791204, -0.798780422778906, -0.361439572539737, -1.94550752933984, 0.1399534040072, -1.79662377960389, 0.768238699060348, -1.56415612162384, 1.73487322503094, -0.551588993909609, 0.0735009414168211, -0.722679468965371, 0.765709880010643, -2.14283395082855, 3.12716274966715, -1.9346118170386, -1.00667420866707, -0.980795697702624, -0.76388580858633, 0.474772333405044, 2.87906350058476, -0.647710920374574, -1.04386686629412, -0.383941716800865, 0.345607107982618, 1.33197285190581, 1.03761094213988, -0.39254018492195, -1.25605307940523, 0.517570781366994, -0.0500200031751348, -0.101527780117819, 1.02106850477019, -0.15548653096682, -0.291893576340684, 0.555265626896981, 0.798479968100744, -0.026787524482567, -1.20900038813917, 0.543217880143725, 0.270150054751016, 1.62937499896628, 1.41928963599724, -0.601907310766458, -1.98958081154114, -1.40995504206439, -0.916658992958857, 1.84291635394108, -0.148436068390782, -0.290243115255992, -1.90140664278367, -3.60429356208347, -1.83842428262251, 2.43948069857519, -2.57132645511382, 0.0801129153622537, -3.33902422848356, -4.71552637981224, -3.00601728677985, 0.0376218781050876, -3.418452955488, 0.190210565368587, -3.51251727603958, -4.99097845594331, -2.51760840146062, -1.46486892353392, -1.9573381272582), .Dim = c(6, 20))
"tau_obs" <- 1.16992583502371
"tau_proc" <- 0.925380766581176
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(22265, 24083, 5224)
"beta1" <- -0.0263870345442482
"beta2" <- 0.790583957368826
"mu" <- structure(c(-4.99183126523272, -4.97973030601242, -4.88073957700798, -5.01090775119278, -4.90236910741625, -4.98444132079358, -3.85597274690738, -2.63854149494385, -3.79295418947176, -5.7845604449002, -6.70457599007959, -4.80263107816775, -2.34951372037301, -2.85694162004212, -5.49234140080785, -3.36981167957456, -4.73835753211741, -3.90209741142363, -3.37742019676141, -4.37450186438029, -5.35954804103851, -2.09363168922428, -3.59440927533922, -2.2159833669331, -4.41472257733549, -2.84306932306518, -5.03588716093393, -1.22385050453943, -3.22588365606141, -0.98818609118963, -4.73720466721844, -0.39441153423925, -5.66893380076557, -3.23770692815576, -4.4684641617145, -0.0157652560966446, -1.94584181432458, -2.34612695848415, -4.23590419315791, -2.20267411959025, -3.73400566849847, 0.898881226330296, -1.28214851457429, -2.64006217917126, -2.42324641954883, -0.89953473147784, -2.70018244682354, 0.069459338116824, -0.977432915408146, -0.596573937604986, -2.3064183550386, -0.768026595253852, -2.0398807678232, 1.27877598116832, -1.15057005229066, -2.34752513060794, -1.2751796760984, -0.620262183459124, 0.376113033808004, 0.217203895977127, -1.49673443866406, 1.15688220200256, -1.78601918672714, -1.00107140746615, -0.242028386624741, -0.183263829079441, -1.57719400598737, 2.20580267668858, -0.627978012320007, 0.28952892158851, -1.29520091728462, -0.789165687921098, -0.257236214741301, 3.89214116258658, -0.424282772180232, -1.11333135935101, 0.0770753017966982, -0.757448628688693, -0.545837131920207, 1.02027734879955, 0.820955109423268, -1.91515711223735, 0.295169872855883, -1.23684632303344, -0.843609953544959, 0.500805454365854, 0.234048756174505, -1.57032955141478, 1.09780688981248, -0.365257060798927, -1.54769504397002, -0.956592342377467, -0.419268913269495, -0.717772812155532, 2.14589601808891, 0.145750087798663, -1.73823747313818, -1.67540889101034, -2.43855339645388, -1.04873154098657, 3.10121476612176, -0.153603627810426, 0.642833381561479, -2.38145275104891, -4.76489272720407, -1.16050957474904, 3.24823565576261, -3.28581424770407, -1.52355027415146, -4.06135218555284, -5.64985318151763, -2.8782698392255, 0.591458392314188, -3.50992342906026, -0.844685388667063, -3.53062032152101, -6.36922935641604, -2.80310509742408, -0.496767170576199, -1.91075632579702), .Dim = c(6, 20))
"tau_obs" <- 1.91492478158538
"tau_proc" <- 0.748375009071516
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1150942879, 625408371)
"beta1" <- -0.216323413063858
"beta2" <- 0.795791430603321
"mu" <- structure(c(-4.88683210766538, -5.01162543057128, -4.97313047179327, -4.94862531444501, -5.01514704798207, -5.09517008326759, -5.20030496216659, -3.36155739737339, -3.07573159699969, -4.83919988536365, -5.12871232282992, -5.78731293536118, -4.95481372981229, -4.09399441259287, -4.38374630214371, -1.53015557568586, -5.61019554351048, -5.00890730513591, -3.56949524690139, -3.04899207272038, -5.1629777664091, -2.20331435142196, -4.92703709474314, -2.39070384272373, -3.62832839589889, -1.54768344900903, -4.8162881338386, -2.19044319055824, -2.67436998186875, -1.70189402054184, -4.07621043811642, -0.867034793673735, -5.00357068837023, -4.23230703353365, -2.88020233691581, 0.25821927205547, -3.37054851605438, -2.23896211185695, -4.69940326606108, -1.96386318943359, -2.83869669629921, 2.21091280641641, -2.18266853736749, -1.43802186125762, -2.61369338035413, -1.42336713390489, -1.69961592816069, 0.882587029373621, -1.45993239649726, -1.19754040106016, -1.37182083153854, -0.669159522545001, -1.9463345045862, 0.920298969440827, -0.0749698039508024, -1.0063175145476, -0.462477442036839, -1.16004942602134, -0.373272235830321, 0.264781444965668, -0.927009002025554, 1.79646376516344, 0.133895888484577, -0.493044926669719, -0.0269453959833507, 1.02690054795179, -2.68021825367694, 2.57086477233611, -1.31908516238518, 1.33375777494859, -0.285389017142988, 0.599079619190713, -0.123498361308431, 3.27172025590763, 1.28587696729223, -1.98224446186374, 0.0285994602847532, 0.663503313471627, 0.288289902262477, 0.921238140071036, 0.837226817353158, -0.463586151296176, 0.419385166457254, -0.351714331778926, -0.799938173518367, -0.943796257986967, 0.240047470790301, -0.562656587039848, 0.611167194490666, -0.00978495191090201, -2.51903908935295, -1.2031958448587, -1.36037546470252, -1.46268384590805, 2.05309357392132, -0.592263529153569, -2.03183548933291, -1.71499476309625, -1.95456790491604, -1.33316652606593, 0.904547774927464, -1.3695673418445, 0.14537398563671, -1.91591930565037, -3.96181093237148, -2.08650932741237, 2.71963758880021, -1.91677578708205, 0.928852496694465, -3.66818616034958, -6.30993774193861, -2.59655995437122, 0.356022226458466, -2.82686389245379, 0.137934775766513, -3.04378514724215, -5.8563924717415, -2.71590854749808, -0.775546395582219, -2.30485138837931), .Dim = c(6, 20))
"tau_obs" <- 1.38291006625955
"tau_proc" <- 0.743314062540837
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.03985637693803, -2.92620621090538, -5.62682143352007, -5.62682143352007, -5.62682143352007, -5.62682143352007, -4.54690127786412, -1.87993516013178, -4.54690127786412, -5.62682143352007, -5.62682143352007, -4.54690127786412, NA, -4.03985637693803, -5.62682143352007, -2.92620621090538, -5.62682143352007, -5.62682143352007, -3.25450300251135, -3.70500883604382, -5.62682143352007, -1.93378396925747, -3.70500883604382, -1.98340435348289, -4.03985637693803, -2.59561477177242, -4.54690127786412, -0.668259465052166, -3.70500883604382, -1.47141661453673, -5.62682143352007, 0.656275705784041, -5.62682143352007, -4.54690127786412, -3.70500883604382, 0.282619278109319, -2.50592601701208, -2.69414729593322, -5.62682143352007, -1.17895504135065, -2.69414729593322, 1.31683709610467, -1.5343304399473, -2.80346038590687, -1.5343304399473, -2.14900600506575, -2.59561477177242, -0.0644318601593888, -0.587706668101948, -0.710089901290257, -1.83508459396643, -1.24966776358807, -2.50592601701208, 0.543834777372936, -0.211214980448936, -2.21091790446822, -1.47141661453673, -0.69595110789268, -1.00895441673757, 0.266662705227706, -1.02834023568278, 2.75681496812374, -0.167708844426109, -0.38184624250953, -0.613227557384072, 0.535674321735381, -2.59561477177242, 3.57824393896632, -1.75100147675589, 0.163478468992475, -0.833329211159808, -0.538539462333506, 1.18099072793401, 3.79205859229696, 1.41259543553926, -1.83508459396643, -0.600385700478634, 0.896332892533209, -0.0134905901824991, 1.55362917560552, 0.870288677312358, -1.27439526862248, 1.06835924549709, -1.17895504135065, -0.57518638292638, -0.69595110789268, 0.0560021901152849, -0.38184624250953, 0.462223441926773, 0.139414055782678, -1.32576386137986, -0.899925377787891, -0.76873316751654, -0.562820918884371, 1.43808003426912, -0.899925377787891, -2.27691734624547, -1.87993516013178, -2.80346038590687, -0.434482057178657, 2.2456548884065, 0.677830476448052, 1.51854994024036, -2.92620621090538, -4.03985637693803, -1.11291407337897, 4.4023144383706, -2.27691734624547, NA, -4.03985637693803, -5.62682143352007, -3.70500883604382, -0.76873316751654, -4.03985637693803, -0.273647683487978, -3.0878475624618, -5.62682143352007, -3.45459815838927, -1.44138432743785, -2.03561606213981), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
