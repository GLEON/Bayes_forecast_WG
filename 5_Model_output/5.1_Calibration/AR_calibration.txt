######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-04-15 14:35:52 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(339, -730769137, 57122831, -241933601, -1647997056, -221010258, -919108115, 1666662086, 756018092, -440852141, -95545452, 144827594, -1249671858, -225287387, 959537413, 198046460, 820017235, -1499773436, -1890433454, 604897150, -1947638138, 1283666699, -1266254989, 1031360678, 961468018, -1129178848, 685714399, -1876853477, 699274451, 742620524, 1209872509, 548642010, 1286980424, 1892591581, 1499936768, -1458225698, -1023172740, 1145513979, -1905523702, 451652218, -460974563, 108795399, -1545473432, 272053665, -816749726, 1625137915, -1244485418, 904805732, -1625769963, -530460991, 775121477, -232708807, 1648989208, -1436137160, 1005730485, -947658740, 2072915702, 254249526, -1719795723, 993289499, -920620624, 69680212, 159609032, 883478221, 2041859484, 2097823876, -991332262, -1481683995, 2011516813, 559733609, -472043362, 1985640536, 945029775, -1275221093, -255560315, -1249399665, -988272424, 1090231421, -1694981673, -243900210, -1009837111, 1325340445, 753385374, -228705745, 408458616, 703257185, 1368612944, -393589363, -1592685937, -90919393, 1482772094, 491909653, 696985728, 2028511386, -795953387, -166023549, 688784310, 1425933178, -7589867, 1611522462, 1626111376, 114869985, -668137453, 21310667, -1011631637, 82259170, -2102613626, -532367282, -291977491, -1375458110, 1597450874, 99323421, -198410795, -639391771, 1456666205, 2042692255, 1968730556, 722756035, -1310238793, -1002739417, 1833387436, -676867535, 501026560, 284647499, 983117447, 705361716, 2095024132, 495463669, -255185525, 611145619, -1526391012, -1991955392, -836228203, -622694724, 1796254124, -1892559886, 1923096751, 539933897, 16571949, -1643701142, -488045006, 1371387363, 1022650700, 1722421115, -573487100, 1546393689, -1781850647, 1659130461, -256849832, -834099727, 1302070153, 1069119132, 2094779713, -427261984, 1150598673, 126089278, 1252758069, 1130293729, -1398003636, -1302321194, -1371911294, -1150136835, -1434642999, -1030885991, -1031534863, -583079778, 1885697086, -2043899447, -751005070, 141228422, 491637708, -2054544776, 903212432, 1591409018, -2145502265, 1919166056, 1493502706, -1331465885, 2138613978, -1102882729, -1342833313, 236408147, -1059325561, -660198887, 338383580, -1863956153, -1360855034, -1915720075, 273991310, 951287492, 1280968050, 835253489, 304391266, -1781192900, -1898132812, -92481064, -865719168, -1558361203, 1566563728, -222746113, 1747359189, 2136965514, -1192404289, -1797541730, -204054016, -1097326082, 23618557, 968843519, -1842576928, 1490384084, -1342250705, 427724546, -503698073, 1574034639, 844870486, -1712627537, 233224862, -744461314, 439163063, 72875859, 988871792, -777815760, -814521726, -21176887, -1455798548, -1872739465, 1827742491, 1851160781, -1827194708, -170606723, 1815801467, -749578757, 1121072442, -1011799834, -203252964, -1671546923, -969535676, -697302927, 1990339115, -582849532, 1733071188, 1492124642, -508851039, 1830849358, -467387113, 1050464340, -178309237, 1941081187, -2030181740, 774314797, 827241918, -1974169127, -1350568280, 685843028, 269666006, 1422690021, 325918970, -73130860, 306936588, 1548078761, 1764671091, -925894464, 1090869385, -916967733, -1493937488, -985793924, -1603164777, 1549149542, -2072349333, -1284465452, 1831218238, -841354437, 1569381234, -407353722, -950430299, -180356457, 1672832489, 261734655, -595495854, -746473901, -1818057130, -791882517, -998130877, -1506222508, -65132644, -663078508, -1247434755, -337014432, -1068519365, -2133904235, -900875428, 238356941, -210767024, -344469067, 843338610, -590757983, 1976258603, 2021977604, -1034772054, -1231655307, -1303296989, 286180485, 541549671, 1015885164, 1502142451, -891767525, 605980756, 319410590, 2131575294, -178188451, 1724610142, -1738461811, -986234582, -42436673, 1792474708, -1371781910, -1705250785, 1483805285, 1025304202, -1865137240, 40043864, 1795918133, -1464481863, -2036628148, 112559584, 185523810, -1828647197, 1029916564, 1852374330, -1633150122, 210414486, 105697995, -791140231, 1411676171, 2019480559, -1540472673, -198490240, 2108570064, 1994492419, -344256149, -41173266, -507655899, -427599945, 2139859698, 444884767, -88741322, 766520614, 234645205, -583293978, 1894620691, 492538777, -1934672949, -1431796899, 1896835525, 1342316738, 1979067532, 364507623, 1320720659, -1856348761, 7978822, 2030548181, 436090535, -530307981, 1587528856, 1998748878, 324906661, -1287112021, 1933807859, -605040434, 39696385, -209172073, 293877950, 191689316, 1862977846, -966504276, 1289616148, -1880601609, 267600899, -1459502114, 86741434, -1643833510, 1871149748, -561672330, 1024752391, -686830328, 1743325577, -1459449419, -864567321, -652717481, 353333183, 647711372, 1296641360, -1122134989, -773327183, 365150021, -1035092109, -107301463, 248336669, 1640385593, -1336733672, -75052405, 1768417141, -2090317261, 917259055, 418356027, 2141254624, 1795312624, -1183404220, -1690702526, 1727884129, -729361281, -743243709, -1998113139, -335802183, -711137970, -499702190, -1940974172, 1087118720, -1367514468, 673578744, -153253889, -845953757, 520435367, 1371312001, -1656314, -1353430631, -1697123865, -210808298, -1565788627, -2031700663, -1451896720, -1401980720, 1059556986, 2025227158, 907697431, 1980753145, 544871944, -351163973, 1537893003, 288405994, 1274241331, 1401947698, -2144093957, -1962395703, 1581388754, -118771354, 734047764, -657221327, 470693809, -427810048, 1774165435, 2048175487, -1778381275, -1513872074, -1891115410, -103457987, -1112410058, -590028074, -805285685, 690825435, -1315776647, 1713715527, 1142868836, 199243454, 703417804, -1561445993, 721638098, -298626076, 1888803595, 1145042605, -2037527113, -2028753161, 132722288, -529076847, -474538332, 687565862, 269082773, 684630251, 209411050, -472709882, -1541902909, 1732930146, 1783738005, -274427635, 1238164182, -1975904523, -1602428500, 195266720, -80031721, 46749198, -537627881, -366251336, 1332580894, 738693458, -1300215445, 1071988001, -837276259, -1287682784, 1616790007, 1285382801, 903188184, -731188082, -378349040, 637725503, -611385650, 1504102167, -318403125, -135140456, 1978716236, 726695825, 661690979, -724585206, 529821852, -810548170, 1091308394, 1781986865, -1013720889, -83167400, -1195121844, 1882369212, 1590741370, 1074270288, 1908013093, 1757349240, -1557899400, -2003171356, 943129635, 1202548776, -984491631, -748922944, -1938715722, -928823331, -2011898819, 1556943319, 721275587, 1498290325, -1168087761, -1281054320, 381961438, -2038345193, 1950650229, -606582664, -231674622, -293201349, -1686183398, -2077606209, 1761391585, 1377664492, 24703718, -346757051, 167314860, 1903591286, -1401447002, 2029353316, -1995933943, 32528778, 909301674, 554920435, -455034964, -1404166618, 941151378, 1881149785, 54192102, -1069345741, 1935898593, 159217894, 798236106, 630725909, -1811615593, 1764838182, -883523564, 1823329565, 76901424, -1517636084, 120381646, 1347293296, -1038602629, 344148041, -1163391504, 662920227, -1219633053, 11836007, 901478935, -1112652238, -1174590858, 16900213, 625856221, 1636458997, -1425889470, -1026076584, 1572157854, -739301231, 157281481, 2129207618, -1330659087, 871162792, -1167198736, 1159939252, 1156579184, 406851290, -1307680764, -565352902, 1993206518, -1918690242, -1015430977, 489234651, -246100165, 788701699, -119863269, -49574840, 1528860078, -1263398172, -890924797, -2096034477, 1629980641, 1814990781, -636951312, 1402435164, 1595093054, 1340506526, -568106213, -762986403, -473461717, 2094523321, -33731259)
"beta1" <- -0.251123707498289
"beta2" <- 0.69975954088923
"mu" <- structure(c(-5.21967236413646, -5.12811189251744, -4.97593561196412, -4.89397403458328, -5.02540740272311, -5.10599278485701, -3.2702164347542, -2.57263861996262, -5.16454690868026, -3.93437693944646, -5.81780006695269, -4.90781203310742, -3.0654288876415, -3.48487482403988, -4.99660979154475, -3.31207631916201, -4.54279920962543, -4.3631366437371, -3.283858067176, -2.89276040252685, -4.16259505773976, -2.91904805140435, -3.7016841517516, -2.20331833281577, -3.48760062516663, -1.69191682856025, -5.03225320426559, -0.620377545904021, -4.18583465085553, -0.0194794333437389, -4.427310087022, 0.365307401792432, -3.89151027311503, -2.02860286724396, -3.22550711929091, 0.254271963170984, -2.10975984254557, -1.82142444162644, -3.46217676154322, -1.63627513476471, -1.81150822976987, 0.18382977620135, -1.28466749720297, -2.55439470435679, -1.80688460475851, -0.756202710572849, -2.5617073099743, 0.627900992900223, -0.367059497021047, -1.36288463430902, -1.8552548794815, -0.673258066998706, -3.15987248777065, -0.336636890115843, 0.0309059244281242, -1.37227369935734, -0.561404482015495, -1.54362810804305, -0.865553463623384, 1.40604106663408, -0.509903756077337, 2.26721375227746, -0.190125759878631, -1.11355507248221, -0.66685429249632, 0.525275160067653, -2.54571407265124, 3.05797455534783, -0.405851803541076, 0.0966084355104973, -1.40196171716156, -0.0173426326480292, -0.65508088077399, 2.74688884711414, 0.0127548951823745, -1.3174111421867, -0.933939707618291, 0.335615631703027, 0.00844054317410746, 1.65135955162694, -0.389330418965292, -1.00202252668337, 0.881528159149168, -0.590219926260168, -0.121980932879442, -1.25022541246513, 1.01808179696673, -0.427507435693556, 1.74748071923656, 0.26373917365105, -0.393039512049259, -1.94022022661696, -1.0857544184806, -0.532220907126127, 1.3448672133131, -0.281236827848633, -0.486020908717762, -2.47768542154521, -2.06154933560856, -0.529664072224132, 2.52004439224197, -0.108060255677808, -0.668813961125683, -2.4201346302683, -2.85790595666006, -1.42735522230317, 2.80921611090565, -2.55876625081137, -0.610665569204087, -4.01138212969919, -4.32067876921374, -2.72608604612158, -0.0440333686773916, -3.07101491402205, -1.22523771884355, -2.54994281645075, -4.92630951510123, -2.73718163240143, 0.0320415764521956, -0.679002101195023), .Dim = c(6, 20))
"tau_obs" <- 1.65897457540882
"tau_proc" <- 0.79193817407187
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}

inits{
".RNG.state" <- c(12784, 23894, 15217)
"beta1" <- -0.470533368318926
"beta2" <- 0.696722106042974
"mu" <- structure(c(-4.94326677138979, -5.05872950145352, -4.99182747603705, -4.95577384483816, -4.92707178375199, -5.01534828622475, -4.14386170965766, -2.13895648812787, -5.04436823443665, -3.57076196948306, -4.43764715795537, -4.69575265263126, -3.86062545668684, -3.78306249510454, -4.82710247793331, -1.72022462829665, -5.52589131142327, -4.05794459242485, -2.92515023607972, -3.22606942367403, -5.05958381588894, -2.50052706936827, -4.06754596188355, -2.14010820425382, -3.92037412804624, -3.35994912631431, -3.84444827309478, -1.90388677571924, -2.72133288742049, -0.659855597819772, -5.78437367150388, -0.773600459484704, -4.02436057583223, -4.9532636165192, -2.21123840137396, -0.390231220325438, -3.05559449889124, -1.58289238305252, -4.2721879194207, -1.02449968212435, -2.9452478307592, -0.0708171662834873, -1.58384450276824, -2.64518576258275, -1.68889455008921, -2.3014015159935, -3.82799422186347, 0.0288255016356255, -0.893626418481901, -1.20958692192811, -1.09825014468602, -0.603805901333686, -2.58684890325374, 0.541190018472398, -0.225398474502279, -2.08928501001785, -1.02833513392781, 0.622972165715937, -1.81669217351891, 0.49256669348212, -0.557180697873111, 2.56618089090765, -0.52516213145043, -0.444703627520665, -0.209116930892524, -0.236416948876518, -1.09903892836337, 2.67469675746834, -1.29017509187192, -1.20808266145632, -1.30049612272964, 0.101533327327996, 1.53172769320995, 3.1589108167434, 1.55783817593152, -1.41511166913635, -0.773270065671195, -0.0236001567047599, -0.395126666742854, 1.75770158759284, 0.830963395266733, -0.95272031634306, 1.12202757420555, -1.04624546976547, -1.48822981666988, -0.224205291628569, 0.0791796517274017, -0.460323562074864, 1.26327177630573, -0.562437050556825, -1.27267552249769, -1.55289195220903, -1.24481062832698, -0.654244669059263, 1.9488450585581, -0.0816486059952576, -1.79347163784432, -1.33348694826682, -3.07885055853843, -1.80840726886118, 1.66934993022925, -0.476318427393116, 0.567813504343684, -2.61054896154641, -3.81123381677888, 0.0393430275779019, 4.47120970155771, -2.5404515719284, 0.16321531288293, -4.37324866278749, -4.64753539489599, -2.5692241100071, 0.598976843724008, -3.4434041838005, -0.0703990508060391, -2.69878117707937, -4.63875951147119, -4.04711637959675, -1.38890616225914, -2.78898679835498), .Dim = c(6, 20))
"tau_obs" <- 2.29047496885617
"tau_proc" <- 0.657528355786896
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Wichmann-Hill"
}

inits{
".RNG.state" <- c(1337490660, 370735323)
"beta1" <- -0.253397201520661
"beta2" <- 0.785439224217853
"mu" <- structure(c(-5.02579967969373, -4.94153299781792, -4.99559810752604, -5.10821403538724, -4.87856213060621, -4.98117725332359, -3.81422602150356, -2.93845426090984, -5.30090167425413, -4.77611780241986, -5.36212921952145, -3.68932638343048, -3.90549741280017, -3.84912538594305, -5.9066342627238, -3.88661598125676, -4.26800007418628, -4.15505435055156, -2.7135362444337, -2.15486959888859, -4.78222400841253, -2.52400065086784, -4.02618616388057, -1.82260408021882, -3.47135639439493, -2.77569213030584, -4.4925418625707, -1.12239801362847, -3.1759945325747, -1.67843925902799, -4.37511194017695, -0.98017589759929, -3.9826302312727, -3.28273594617212, -3.7963527053986, -0.586970707658033, -2.29111080992422, -2.98966359101519, -3.37817675457775, -0.979659486055211, -2.32439151337654, -0.429047859244623, -1.76664385321422, -2.36368074122424, -1.79465567905768, -1.40745944267943, -2.18739617852814, 0.134992749961428, -0.82344497318179, -0.35403835430375, -1.4963151084732, -0.315379038084487, -3.11928121945807, 0.543357561434328, -0.609914777387306, -0.238166753194174, -1.11850342704918, -0.331928060219894, -0.785623196790639, 0.0752251693884901, -1.38492466211922, 2.44152438556757, 0.661922949267632, -1.03964318916423, -1.07533416459921, -0.30310032709095, -1.58752799650255, 2.80751757144521, -1.13437690409766, -1.06068753720922, -0.322992536034792, -1.40461732628442, -0.456797905393125, 2.43080834771625, 1.096783195666, -0.670516992284631, 0.759427195583395, 0.405536041733793, 0.243418260737421, 0.360808833941072, 0.0293742893664352, -0.324993523284864, 1.09260088950459, -0.480874818325641, -0.218237533670957, -0.133178492480061, -0.244224576966075, 0.390102153130093, 0.893582123428321, 0.526402550920993, -1.40453481374946, -1.21434750570199, -0.226359815651208, -0.79518180279995, 1.55747595937492, -0.470408825783372, -0.618873383861173, -0.924186460869559, -3.22559633687222, -1.20004509342163, 2.87034483978275, -0.812738055284166, 1.55940712763358, -1.696291039032, -3.46580016788063, -2.22117530285229, 2.75312338568686, -2.02751052023693, 1.9102432511325, -3.26366274984089, -4.70624739112806, -2.0498322625064, -0.388138685570737, -2.45527818586326, -1.20453849474541, -2.30263877158835, -4.32729511724167, -2.31943958834469, -2.22688286020346, -2.23787097249483), .Dim = c(6, 20))
"tau_obs" <- 1.68068461985416
"tau_proc" <- 0.778697739318574
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-3.85980369014249, -2.86343927118061, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.95159275346247, -4.26355862228935, -1.85743696973239, -4.26355862228935, -4.95159275346247, -4.95159275346247, -4.26355862228935, NA, -3.85980369014249, -4.95159275346247, -2.86343927118061, -4.95159275346247, -4.95159275346247, -3.1683696152567, -3.57297780368645, -4.95159275346247, -1.910055720008, -3.57297780368645, -1.9584839181152, -3.85980369014249, -2.55012206191651, -4.26355862228935, -0.661508725238449, -3.57297780368645, -1.45640727768747, -4.95159275346247, 0.658075359447239, -4.95159275346247, -4.26355862228935, -3.57297780368645, 0.285233178195202, -2.46425572610276, -2.64405992074449, -4.95159275346247, -1.16773044583689, -2.64405992074449, 1.31776713186147, -1.51835421625552, -2.74774570870643, -1.51835421625552, -2.11966258526556, -2.55012206191651, -0.0607354836898151, -0.581476769814426, -0.703051798172265, -1.81356262524385, -1.23762564284707, -2.46425572610276, 0.545848385406104, -0.206935445467576, -2.17972929416229, -1.45640727768747, -0.689011472830919, -0.999476338867932, 0.269318592960969, -1.0186775184919, 2.75703540249097, -0.163611130691224, -0.376772502579018, -0.606837133839059, 0.537704412220319, -2.55012206191651, 3.57834089259093, -1.731198082625, 0.166422615608164, -0.825371688593113, -0.532607577803059, 1.18205601731843, 3.79213688288921, 1.41344057964001, -1.81356262524385, -0.594076560473089, 0.897748741042104, -0.00997747407868495, 1.55436319024868, 0.871741857734603, -1.26205351705275, 1.06955146236881, -1.16773044583689, -0.569033760516405, -0.689011472830919, 0.0592798458080164, -0.376772502579018, 0.464408088230409, 0.142429802890188, -1.31277577255996, -0.891422193820534, -0.761271566892886, -0.556743678768707, 1.43890392109862, -0.891422193820534, -2.24363589004942, -1.85743696973239, -2.74774570870643, -0.429134835254822, 2.24602237489292, 0.679591787844505, 1.5193101505469, -2.86343927118061, -3.85980369014249, -1.1024030572059, 4.40235696751028, -2.24363589004942, NA, -3.85980369014249, -4.95159275346247, -3.57297780368645, -0.761271566892886, -3.85980369014249, -0.269093075706006, -3.01446390455736, -4.95159275346247, -3.3503483160569, -1.42681583503013, -2.00937729712331), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
