######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-04-10 11:03:04 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(1670628542, 419393884)
"beta1" <- -0.395389287252482
"beta2" <- 0.777822781005197
"mu" <- structure(c(-5.05169582096493, -4.85940603649254, -4.84511176436806, -5.07170752989055, -5.06775543331781, -4.99887959883526, -5.1456274804363, -3.51827917349711, -4.94710222783091, -5.10164899231739, -4.92859911646757, -4.53198104962495, -3.67366462630934, -5.20465529885132, -5.47372095233147, -2.5445699716284, -4.58644232304691, -5.18460712614274, -3.78448161024141, -3.18764937740542, -4.66544077749436, -1.70445332300994, -2.59941577393624, -2.82961867445099, -4.60129393474873, -1.74208960885602, -3.65954808572015, -2.0291405589587, -3.49670798132517, -1.29214588219896, -5.38529919737566, -0.855886187526828, -5.52105060127659, -3.40738132021592, -3.08787544143394, 0.103239591009348, -2.75847238704926, -2.11132653471951, -4.6223942981272, -1.07779396286313, -2.95015961422119, 0.686303262154629, -2.30952659350238, -1.79096814390558, -1.65734259045319, -1.89007712770759, -3.90100909120209, -0.475445554186701, -0.466696503985174, -1.12247457508694, -1.99915397473555, -1.32683890423164, -2.31502198448768, 1.01564850301868, 0.429236607698752, -1.09351140049346, -0.547068074871008, -1.35882041003424, -1.49517881320517, -0.223813356788866, -1.24161804982983, 2.29185778540743, 0.61986913030597, -0.749544926251791, -1.14745093664841, 0.57422734023843, -1.08592489103256, 3.61869296934753, -1.84195403101306, 1.04465040136161, -1.13082182636873, -1.16517491559431, 1.91651269230599, 2.17187665605269, 0.490851667638571, -1.55635154125657, -0.141342325534732, 1.04738770317288, 0.0354310849853639, 0.385700490748416, 0.577236974735925, -1.49185708282515, 0.767312145964555, 0.240341029423234, -0.350559181920432, -0.125288187346018, 0.221841267458763, -1.03833923616927, 0.321981199244951, -0.394197098392112, -0.870474613853864, -1.22443349560631, -0.0776364604155723, -0.981013193903686, 1.39979203177135, 0.811366987979065, -0.2799948298805, -3.1510290959082, -1.59683840529448, 0.766826348274113, 3.95006056110076, -0.505976984397888, 1.05194036827314, -3.16742369377728, -5.10604596867113, -0.762508775565364, 4.10526749865724, -2.26575251559908, 0.309222451651802, -3.02496064256761, -5.25103183564511, -3.13230503728827, 0.65924104279865, -3.21301884306845, -0.127806645593481, -2.51129359803082, -5.21590016640448, -3.59934845479125, 0.0543666432852352, -3.60112846150714), .Dim = c(6, 20))
"tau_obs" <- 1.84659873018398
"tau_proc" <- 0.593091853262629
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-817033199, 924432607)
"beta1" <- -0.472882588885286
"beta2" <- 0.71211785442024
"mu" <- structure(c(-4.874788162014, -4.88081494195725, -5.05372010733372, -5.06419976398369, -5.06427976371378, -5.07222460211303, -4.26973269985968, -2.26869345681967, -5.04037248951389, -4.3252493576016, -5.58826531475731, -5.01712856440257, -6.64021087304997, -4.98615368481084, -5.92667081019233, -3.61492584460506, -5.57171826331554, -5.06435660844557, -3.20976860046985, -3.75415633229514, -6.19672083842084, -2.03121013283593, -3.93895529725236, -2.83170840879343, -4.41660050328213, -1.97477885330656, -5.64059296581321, -1.24292159003369, -3.41665990208404, -2.47962373697398, -4.83047833340218, 0.99245875584782, -5.9689213275812, -3.42177551132075, -3.85320321101997, -0.550406371567603, -2.94377001223438, -2.84024440167899, -5.57495583852846, -2.56263799966024, -2.81506516820503, 0.512646703068803, -2.63879627314559, -2.60594489716424, -1.7501535974675, -2.17183677817478, -1.97724685558503, 0.285968994863246, -0.637996910224388, -0.965445722637281, -1.85477658553155, -0.398375640801095, -1.90861241409763, 0.703747615681259, -0.40053331842196, -1.24022379477261, -1.57877282812847, -1.3723350920489, -0.717379524667793, 1.6255270838367, -1.59394851195002, 2.43406560664919, 0.564483139042122, -0.201008217154985, -1.52664564704178, 1.04014422325757, -3.16364570556654, 3.61550702569953, -1.37880654626409, 0.289892679518657, -0.352094790644047, -1.71142780068082, 1.27565895544207, 3.36769619628263, -0.555118035811785, -2.12507165935306, -0.133622303330427, 0.189006157513807, -1.4609396836442, 0.704110962122356, 1.15255210827178, -1.11483275096917, 0.882497244427995, -1.56735612859536, -0.879334965112191, -0.754717108238959, 0.125473816659982, -0.0562628029140249, 1.3674152712412, -0.900708838072806, -0.641424231688813, -0.723731789309119, 0.217676189960186, -1.1642258874809, 1.61468950322582, 0.0914510218044304, -1.73190580036764, -2.01771739651117, -1.09098700408156, 0.139523869009586, 1.81167234807883, 1.3946066158898, 1.82022663517965, -2.6761969807654, -3.30213369407751, 0.138967902942736, 3.4539941532156, -2.14391975923267, 0.717795999984031, -3.06317908474498, -5.76770485711434, -3.02255790987625, -1.77597719086718, -3.33137195884132, -0.975642343388163, -2.51902056932365, -5.08143608394894, -3.96534118649163, -1.48709881490487, -1.9455247748339), .Dim = c(6, 20))
"tau_obs" <- 1.77819798634261
"tau_proc" <- 0.524646057897104
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(175, 934129409, -86201282, -419463459, 347546459, -1557895994, -1199932426, -1976009588, 816563627, -1107895349, 296305085, -1635310662, 1124562459, 108448098, -1559720719, 1985923581, 1865399188, -1494722549, -1764068653, 2112864300, -261730387, -1677542714, 782749440, 1212399482, -760156667, 2014075927, -403214472, -2134853310, -342042457, -492721692, -2115028949, 2006114774, -1291108990, -1794046919, -2054160385, -1711477657, -1570174227, 1820234779, 1496048506, -1651721387, 2045378624, 2015409222, -1448223398, -831167717, 1957203479, 1250703514, 1529613827, -1682741538, 155622892, -1286982519, -1801168406, -890024691, 806180106, -505942353, 2036856418, 237202, -592861911, -2077913662, 378278374, 1780328735, 1603186923, 1129675116, 1168053172, -1948220385, -1113031398, 2139498999, 579814762, 810887318, -1839691768, 959106230, 662493720, 630261011, -654932839, 240907630, 1192285040, -712621067, -323147883, -349813528, 992582067, 1161332545, -26608901, 1004733633, -1992668523, -1893298675, 21666020, 1551418670, 1923428887, -1477090425, -950519520, -987069, 943610850, -826414679, 1514914297, -1940922018, 1912512359, -1188806643, -562114853, 1002867419, 2105912198, -623445427, 1400751, -289117547, -2072773623, 742690935, 1806381055, -1047811316, 375728085, 1355608589, -541480918, -1799595091, 1975674177, -4450522, -2057706911, -1907154721, 1211233658, 1839722980, -1681836102, -692476787, 416252827, 528973629, -889730264, -217962518, 1266681278, -415888834, -38510310, -1213342383, 1239348368, 1577256150, 364103684, -1733872959, -122107754, -1741082504, 1543685937, 124772540, -648196472, 1110015907, 1675201329, 1193114576, 259234309, -375716812, -1986161704, -2030936339, -1150720187, -1576890865, -691187677, 1432774448, 1743337744, -1812014328, 500072854, 1801926799, -1604405789, -928470265, 2051924435, -2024506790, -19389917, -823571602, 203849293, -604450040, -899380880, -144206158, -564147329, 1372083363, -2116432698, -1428318722, 859929294, -1547722778, 53729383, 747261144, -1956636059, -347599927, -1196516674, -431954220, 242468109, 1324671103, 1142815038, -1304514879, 839437910, -1028743673, -672118006, 468976202, 1787910000, -874953478, -656971325, -1834773755, 1950494364, -1908706595, -290338750, -196200663, -211908058, -1763541809, -497757223, -1137330100, -1745816240, 1900584508, 1382958752, 689462873, -1594963441, 1186761553, -1004256569, 96326355, -110363657, 2029666584, -296719479, -858357043, 757634410, -865751733, -1693191002, 2000685005, 989296110, 46940570, 1322662215, 1243932873, -321769144, -609014089, 1427748362, -1044380481, 986156471, -1835332829, -1405116240, 618744460, 66567757, -12926071, 1610669753, 1872700344, 989554992, 310644358, 1293473373, -1937224695, -195309190, 1186079840, -1045125986, -107120877, -1000776125, -1934632674, -699798799, 505087124, 1126401291, -1835796573, 904663680, -388156526, 41023988, 135189251, -1602979471, 1257881633, 1535966332, 1218056669, 2007440240, 1549515594, -1487099100, -1459907126, -1116963915, 1066295360, -1462909606, -1360776359, 1120357049, 1375280162, -1809589093, -1912061967, 1301856598, 1480123333, -760769402, -1070023018, -475944415, 1352653392, 179392869, 371111714, -16245226, 329323950, 458443017, 2103594199, -1031535811, -651303036, 1986821106, 2007790603, -1070090183, 1500378150, 1963322457, -739162142, -1866383119, -1049238495, 1614541770, -216319076, -139975126, 604046759, 522085107, 1531598925, 182830301, 869659352, -720358013, -2020272968, -745220592, -1540004961, 1123835923, -1227338823, -2044876770, 2147367034, -533620326, -1580350498, -1880096403, 1038357218, 1353696368, 1154031404, -1020639989, 1186797546, -1416872123, -502818366, -2122752877, 1774153663, -571874620, 188233713, -498662814, -1718183590, 7758494, -210278006, 1260011792, 1237924921, 781058519, 1586569932, -1781394983, -180533609, 147295760, -1743719170, -1338899280, 1664276446, -2074553904, -2057909804, -319046998, -860637285, -67277829, 349468465, 1119034730, 2098413857, -126123105, 1087322585, -1765330149, 172052271, -2061679767, 664242541, -1674456167, -2106039132, -93025720, 387150944, -1287912002, 466186137, 878330508, -695377548, -779896747, -112759712, -2043112196, 1958493746, 361818771, 1410506563, -1233025388, -1081998290, -1393703764, 1637754464, 734741849, -1613190841, 1544440833, 1218417470, -1384027036, 1967654193, -51417459, 1889590489, -1180217403, -1088829255, -1890383793, 2057919505, 2023198972, 2036981938, -1329631412, -902305113, -1680408575, 2017165619, 123035960, -2090142016, 565039836, 2094502841, -2023414209, -191319658, 815404251, 70257165, 433368091, 934276657, -1499618594, -1607312377, 1842791198, 1939725449, 1373434880, -961195584, -220398540, 1353518847, 1786949037, 373447546, -908815345, -1671189161, -1861287170, 983295449, 358518993, -1311371198, 720843141, 1853529929, -622558231, 1925143840, -1638154666, 220608028, -1091157182, -358407275, 1181250281, -2022513968, -171086625, -703661335, -1045066941, 333339047, 93259182, 789650250, -1668202995, 733966173, -1957596612, 1710580302, 570859143, 354067831, 1502844174, -280866507, -120805906, 322804839, -660749986, 984050237, 542422968, -1676516524, 2134439009, 1641438926, 1442142558, -410836424, 1002171018, 918593023, 1561604016, -2116224741, 363782265, -349459134, -17297415, -2052267313, 878796757, 642623347, -1904301042, 1076320309, -728769472, -1171069541, 1381284684, -1340876730, 1807253358, 1843622409, 835889304, 381496102, 166681233, 571849655, -389021127, 1563809292, -964641018, -751544336, 1799531422, -305684240, -1010831350, 1562637677, 944690432, 358653022, -977100798, 193281664, -996977968, -1813323577, -1240120275, -857805120, -641487985, -1905958478, 1312797014, 1381360969, -668390905, -1168025157, 606194738, 868192597, 1091165270, -605373150, -812424177, 1499459084, 1050863822, -2055307463, -442800445, -397729624, 912913854, 346362612, 1993591061, -1333595927, 1264652470, -1484522355, 1209244254, -214366850, 1751198862, 792872560, 80454074, 398935296, -14710979, -1661175574, -252186440, 1170754483, -1887182852, -544967388, -2115740751, 834511767, 866639410, 417930346, 1877144689, -1400345169, -1568552772, 39048973, -1858694288, -662715273, -1275795512, -1669379068, 1157695062, 1757501494, 859093957, 1211104717, -437941025, 70878200, 1491843024, 1065942675, -535348022, -508299603, 857650028, -1202801903, 554854630, 1294954614, 1982842590, -2080565600, -1801306696, 645290977, 827304708, 2057365053, 1317254866, 661329084, 432219132, -1944861775, 1623098926, 1643560642, 38453926, 1417203331, 446519311, 1149350400, 1495709171, 458034786, -1436304213, 579006849, 1705682821, 402375020, -1875861247, 916683498, -843859362, -794365846, 1569147298, -2070244092, -83928059, -1740078283, -1822358433, -1876562528, -660201227, -479198412, -546509529, 1811039617, -1408166786, 1154447526, 842364889, -336221874, 1241184428, -1801750994, -1639694241, -1145808296, -1828584050, 29570848, -1035298871, 1049353032, 5002176, -900176912, 79306774, -405644112, 1734984835, 477488158, -1319107816, -1673827540, 931362363, 602401570, -1298567712, -1703479234, -1603703430, 718370419, 1497009302, -1654644213, -753430971, 1838170648, 1532531941, -1882490502, 972747313, -294887304, -1295695253, 1623956930, 897278132, 619690269, 1882471016, -2038380409, -1443108815, -405801669, -555403722, 864526039, 470280687, -657935221, 1973829588, -142825411, -1657299243, 897450084, -1809557185, -529687218, -866339592, -173074661, 1744777188, 1323613483, -129662330)
"beta1" <- -0.181952441678721
"beta2" <- 0.779744095546331
"mu" <- structure(c(-4.92203581707812, -5.04090346022887, -5.01634078561588, -4.87145031517882, -5.01154450466299, -4.95976271639096, -4.18434438048273, -2.23787517532284, -5.04357011318658, -4.30824263871537, -5.58409600038131, -4.6982511644605, -1.82964171105857, -3.33582352504885, -5.83309771333546, -3.16987861242444, -4.9257497634128, -4.86405546439648, -2.3012818401355, -4.27141521537357, -4.68142308097746, -1.52476078629736, -3.11577108319945, -1.08911881709015, -4.29095874063279, -2.15598466907713, -4.31674975316672, -1.8354375736829, -3.93775047454849, -0.753956354652079, -4.30696390137782, 0.475697993537902, -5.61408871413929, -3.82595527435552, -3.39055413467419, -0.656172369586063, -3.15838059941982, -1.59544120262219, -5.08319794270286, -0.428837604801052, -3.06421459008735, 0.979681117354901, -1.30553130266465, -3.08665351058826, -2.28343829926812, -1.8138858211317, -1.91150352370022, 0.233728600474237, -0.857935750552451, -0.317394165481377, -2.2842159715883, 0.418986527662094, -2.98049087719874, 0.707150234957998, -1.20856993996014, -0.806946042288309, -1.5746422872167, -1.18365581483588, -1.56382800420002, 0.200931385323721, -1.4075146750314, 1.25347748821806, -0.212802039768628, -0.328991677726568, -1.29879173903813, -0.263918305562352, -1.6792702274585, 3.31195455842111, -1.26439120949817, -0.965637342701979, -0.522169197775006, 0.9524168561943, 1.1202220340858, 3.78450319075363, 0.133660170178627, -1.40366507184894, 0.324730208936303, 0.782104523693997, 0.668727868834489, 1.42830314615689, 0.19878843547893, -1.98817526863735, -0.0449725677798557, -1.09387189464899, 1.45711637521991, -0.366437456374994, 0.645462085071135, -0.385363554768482, 0.749119879608867, 0.18753972658924, -1.15733894765764, -0.846707660003799, -0.522894395144163, -0.302748854208437, 1.26333096680347, -1.26887144408913, -2.13171591358921, -2.16136747905545, -2.24581827780717, 0.329440613167005, 1.92054091577952, -0.0735846059730346, 0.127233519187895, -2.57313459078128, -3.30582007292399, -1.10091650605098, 3.86130548582301, -2.36415069747653, -1.24811639118922, -3.24470440232501, -5.00226203032573, -1.66788484421547, -0.788657111106184, -3.61167025379904, 0.0336192668176184, -4.5605194516239, -4.58520290108375, -4.40256343278645, -0.897191461057303, -3.71581585997903), .Dim = c(6, 20))
"tau_obs" <- 2.06932415158549
"tau_proc" <- 0.556116854003044
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.04555439805267, -2.92807362508018, -5.65499231048677, -5.65499231048677, -5.65499231048677, -5.65499231048677, -4.55638002181866, -1.88059068293467, -4.55638002181866, -5.65499231048677, -5.65499231048677, -4.55638002181866, NA, -4.04555439805267, -5.65499231048677, -2.92807362508018, -5.65499231048677, -5.65499231048677, -3.2570970376884, -3.70908216143146, -5.65499231048677, -1.93447577142965, -3.70908216143146, -1.98413136187551, -4.04555439805267, -2.59695615359662, -4.55638002181866, -0.668454567969574, -3.70908216143146, -1.47185224948154, -5.65499231048677, 0.656223826455347, -5.65499231048677, -4.55638002181866, -3.70908216143146, 0.282543894595657, -2.50715225873532, -2.69562768110365, -5.65499231048677, -1.17928019173556, -2.69562768110365, 1.31681029758931, -1.53479436943833, -2.80511191394534, -1.53479436943833, -2.14986400597638, -2.59695615359662, -0.0645385211375712, -0.587886669902452, -0.710293339394916, -1.83571135675724, -1.25001674282734, -2.50715225873532, 0.543776723905677, -0.211338505864447, -2.21183072972558, -1.47185224948154, -0.696151689580244, -1.00922872753342, 0.266586109157047, -1.02861991684807, 2.75680861873598, -0.167827110643502, -0.381992751923022, -0.613412212541092, 0.53561579257321, -2.59695615359662, 3.57824114649315, -1.75157767959522, 0.163393546908436, -0.83355933427669, -0.538710827255527, 1.18096003001686, 3.79205633738096, 1.41257108419811, -1.83571135675724, -0.600567999266852, 0.896292085367465, -0.0135919535194671, 1.55360802747343, 0.870246793372748, -1.27475298638698, 1.06832488772965, -1.17928019173556, -0.575364144903562, -0.696151689580244, 0.0559076319382961, -0.381992751923022, 0.46216045178471, 0.139327065221099, -1.32614043830014, -0.900171349994272, -0.768948893976227, -0.5629964960949, 1.43805629567848, -0.900171349994272, -2.27789248040367, -1.88059068293467, -2.80511191394534, -0.434636485408444, 2.24564430253124, 0.677779703428824, 1.51852803707426, -2.92807362508018, -4.04555439805267, -1.11321844105747, 4.40231321347409, -2.27789248040367, NA, -4.04555439805267, -5.65499231048677, -3.70908216143146, -0.768948893976227, -4.04555439805267, -0.27377916728279, -3.09004295302523, -5.65499231048677, -3.45776773315055, -1.44180707105015, -2.03638205221939), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
