######################################################################################################
######################################################################################################
#### JAGS model file written by runjags version 2.0.4-2 on 2020-03-27 16:10:43 
######################################################################################################
######################################################################################################

model{
for(k in 1:max(year_no)){
for(j in 1:max(season_weeks)){
#this fits the latent Gloeo to your observed Gloeo 
#run this on logged data
y[k,j] ~ dnorm(mu[k,j],tau_obs)
}
#### Process Model
for(j in 2:max(season_weeks)){
#process model for Gloeo
mu[k,j]~dnorm(lambda[k,j],tau_proc) 
lambda[k,j] <- beta1 + beta2*mu[k,j-1] 
}
#Loops through items in seasonal for-loop and defines initial conditions
mu[k,1] ~ dnorm(x_ic,tau_ic) #keep in mind you'll need to index like a matrix 
}
#### Priors
tau_proc ~ dgamma(a_proc,r_proc)
beta1 ~ dnorm(beta.m1,beta.v1) 
beta2 ~ dnorm(beta.m2,beta.v2) 
tau_obs ~ dgamma(a_obs,r_obs)
}
#monitor# tau_proc, beta1, beta2, mu, tau_obs

######################################################################################################
######################################################################################################
#### Initial values 
######################################################################################################
######################################################################################################

inits{
".RNG.state" <- c(1223312078, 215672091)
"beta1" <- -0.35557556996417
"beta2" <- 0.777577714783516
"mu" <- structure(c(-4.81055006315466, -4.87744909645917, -4.85298259142866, -5.01189077427696, -5.03680285201568, -4.84060053839436, -3.53709815452538, -3.35464275287202, -5.33561923765201, -3.61899433867619, -5.91036871953392, -5.01515576381589, -3.58493079052837, -4.01988247884374, -5.45853904255743, -2.9654111454594, -5.0770145791977, -5.02090666324071, -2.86925996453359, -4.27624987662249, -6.29720253309843, -1.3883089774472, -3.4699583731843, -3.3617076498248, -4.22993821452599, -3.39755458820489, -5.16258456511225, -1.03472730799077, -3.63001904960427, -2.27775198141031, -5.35688294825662, -0.235225413267971, -5.79408638770654, -4.0037637668788, -3.01263026006599, -0.488219643759694, -2.71177063818263, -2.18640329964526, -4.32148924697852, -1.72164502596095, -3.0275261426831, 0.128088976850809, -1.64968721404086, -3.16051662899174, -1.50479597924504, -1.67293489046726, -2.51014252075427, 0.951719867163147, -0.760422088496708, -0.418580184184025, -1.7176446663153, -0.936034320820437, -1.13439204481882, 0.663521021428746, -0.448569890416495, -0.580693874049841, -1.48037656097405, -0.335972476222247, -0.396317769112165, 0.199259146543057, 0.288809842482363, 2.19176820622453, -1.7274844452034, 0.357323311245876, -0.876543797811923, -0.101422668629855, -1.2351483009248, 3.53472388761203, -0.73447687940683, -0.00186100825340374, -0.220028238584301, 0.503906270633892, -0.215237669598028, 3.36887393978483, 0.0329086672909938, -2.09047498443915, -0.132722262093732, 0.960036996410811, -0.484681874947416, 0.928772989248264, -0.622337187374687, -2.25305875672055, 0.984394248482444, -0.724571447068658, -1.23221535922257, -0.432261173912996, 0.00858392838250354, -0.551602704011961, -0.136232437423687, -1.0041065414352, -1.80191120621581, -2.59524120631073, -1.08725710225871, -0.0658879502923051, -0.0497624996206265, -0.422472500845488, -2.18639224805518, -2.41083027070463, -3.13110796979343, -0.598120841705357, 3.31747284424396, -0.095175412755433, 0.15490300581107, -3.06546513772813, -4.25659993942249, -0.596819683647349, 4.09788011646589, -2.30925338592931, -0.0351076719828597, -4.45292613277023, -5.75022149375552, -2.61118993487927, -1.2465730684584, -2.93965770751847, -1.26064187838395, -4.20408028234638, -5.62028204312144, -3.14207767501079, -0.872471661911122, -2.29422912761549), .Dim = c(6, 20))
"tau_obs" <- 1.62641990232937
"tau_proc" <- 0.736920389046877
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -1.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.333351135253906, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Marsaglia-Multicarry"
}

inits{
".RNG.state" <- c(-1061166985, -2024359127)
"beta1" <- -0.293162558150829
"beta2" <- 0.657288976250674
"mu" <- structure(c(-4.94230199051731, -5.12798737651389, -4.91696980134499, -5.09869464783742, -5.07629925658333, -5.18417818726464, -4.42754463787993, -3.49613943357221, -4.94099651162175, -4.85969199064671, -4.66182398591533, -4.60786431072623, -4.07509426119443, -4.31061183190811, -4.83088830064674, -1.33749406956631, -4.77621960285069, -5.4343863661343, -4.2024541669459, -3.18421697168315, -5.37747565233899, 0.571498755787148, -3.54697088433244, -2.6099714221975, -4.57161527340414, -2.45194833142578, -4.36140241607547, -0.900043777086185, -4.32219632510385, -2.7173387034374, -5.56845189890438, 0.0639096389571953, -6.08856601270282, -2.52936984282021, -3.74888128816602, -0.47972920348892, -2.54967914991292, -2.61501177725661, -5.15346220298741, -1.80972317382697, -2.51521030110853, 0.637511386568105, -0.543495427957308, -2.51799364947989, -2.57510195394519, -1.2565722528233, -2.27728291413594, 0.624455668537386, 0.470527590484114, -1.44030684681586, -1.03318124310742, -0.27929910381446, -2.28343646841796, 0.711669915168006, 0.35111363527626, -1.33527643116979, -1.9594960278557, -1.21125662353385, -1.46051576730808, 0.181879869644609, -0.730820603024787, 1.82291551507547, -0.202756182881607, -0.506412673524074, -0.400631936095205, -0.462816270736171, -1.16418416009379, 2.26517580745615, -1.84732566677495, -0.279989549784484, -0.782912801204755, -1.19952960059356, -0.230432982381337, 3.4847555642582, 0.394618644842467, -0.970961178187268, -0.186820803713636, -0.0974285717198056, -0.839314127370607, 1.22101500878766, 0.638074472351755, -0.331508793742043, 0.379856171645952, -1.02171074875924, -1.41234181330942, -0.740282752942616, -0.487516655467375, 0.346729565716725, 1.11795161982683, -0.488194920894301, -1.20722733517774, 0.107948359850868, -0.551927833039484, -0.436450890406154, 0.527931625172888, -1.41210472725363, -1.86351957165352, -1.17785329521978, -1.88756682111598, -0.325972109206139, 1.8575349306495, -0.0677023665923242, 0.743658309872977, -2.44631947674964, -3.40043708246684, -1.63985610314896, 3.54446700626708, -2.11984226312743, 0.385038868182577, -4.1195371774174, -6.22841191160765, -3.37170843819594, 0.724542340096736, -3.87461881073931, -0.29577515221202, -2.54870207876498, -4.70084405825096, -3.51980641347985, -1.68209286980801, -1.71787175309964), .Dim = c(6, 20))
"tau_obs" <- 1.90674573891639
"tau_proc" <- 0.708464367127865
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Super-Duper"
}

inits{
".RNG.state" <- c(360, -278981820, 1499713829, 549883576, -2119077614, 1583010148, 220326051, -1720587314, 1359716003, -614602471, -1411493047, -1216963699, -139812755, -1078313118, -1983716819, -2054045627, 870511013, -244602791, -2110035661, 1218047703, -1054488647, -288779908, -1770925063, -1018585142, 1897845216, 1774253379, 1408626797, 1607180128, 1325885844, -898658005, 1047606966, 764789145, -1514756044, 1003852965, -2039684532, 408732758, 1146228578, 1296570076, 526585041, -2021362996, -2027915379, 2016105834, 542224438, -6204077, 1663267476, -1495418533, 356428531, -1022572702, -669921054, 885339245, 1052063193, 1037570635, 1029753258, -1495129412, -2003445066, -1295279080, -1873552294, 949147703, -28125639, -1113165418, 73568931, -1558011535, -501421758, -1256768768, 1302685214, 1064041636, 1310135848, 231245263, -1684885021, -159056253, -1113785301, -1061553801, 1671563368, -136394436, -193356744, -147224129, -1911071133, 1178296832, -418509242, -1046366874, -987937841, -2051373229, 1730697364, -893120888, 357291829, 938436223, -64864061, 653315752, 754853793, 1719946654, 865663263, 492636353, -1480744688, 383605045, -144704759, 1244662537, -2073290889, 607760576, -499793984, -1540146411, 1527663945, -923838093, 229552960, -1517941249, 362954029, -1784956846, 1124833286, 1619805821, -1933729106, 2120505999, -179475824, 1277729848, 514555691, -1367449025, -1120737468, 1342975472, 1519234519, -197932918, -1480409641, 287099102, 453432647, -1574942952, -589415492, -1666770719, 808056819, -31169762, -1758489838, 1376729228, 1536864471, 1825438631, -688276029, -327203509, -1485629956, 634387578, -809415502, 510713394, 1666089726, 1465980978, 1656193690, -281094750, 676685355, -1769004879, -396469536, -822809244, -1891128788, -1966262207, -416046681, 57168581, 411173315, -151853948, -41133448, 1469129813, 1969166000, 464068467, -686000400, 1281252336, 740451209, -203783034, 240496602, 1610556711, 1227215254, -792441275, -601939222, -772766429, 1376894476, 1736509556, -144655348, 863017304, -850984220, 1216487815, -1847700611, 1668151223, -572807145, -1426140673, -2508755, -496325006, 1890104333, -1007264767, 141236148, 1201074671, -727706754, 363116139, 1743352390, -1972110801, -1441126861, 1574057829, -1995847490, 1250487705, -592340351, -1936623970, 683917841, 1049242333, 802062909, 260457514, 1730994861, -336931676, -173832254, -1131208047, 1801095668, -1305424971, 354659783, 939323979, -1769082710, -1671247818, 766991510, 1191912413, 342631429, -1615193548, 2105308444, 1167475332, 213419359, 411438512, -142519884, 1267745458, 1734362448, -1089406417, -1219520372, -715484100, 539355892, 713467100, -1191004944, -13945269, 1187544745, 562154238, -653112294, -1600594579, 1458661433, 317500882, 411508843, 1115994100, 1372444598, 1640256115, 1451090418, 1034653378, 1983955745, -1736756418, 732958132, 1415023689, 994542410, 1646002973, -1108632196, -335170116, 908479749, 1207265690, 833386136, -730628454, -1549583941, 1741666074, 1458164330, 1866008841, -1804358980, 363803820, 988047288, -996775486, -1095921305, 1079327748, -1501942685, -226871064, 1350755879, -610193974, -2054611932, -253417072, -1429362290, -417846259, -796399076, 1285097725, 1063700665, -948105740, 1881289664, -1196352694, 1560660067, 1035256793, -1834111426, -113873273, -75627228, 692424233, -2035810090, 1717684492, -1534160289, -773210275, 418967926, 668839962, 1417473332, -1079542140, -273234320, -2073930470, -1010541463, 1031282145, 1509958086, -930669102, -1120715265, -21603350, -2049654524, -373909936, -1965546212, 510684923, -890939525, -1204639211, -1821503028, -106350611, -1316075713, -479477187, 156045554, 110868436, 1322372076, 544323572, 676311447, -448224358, 1069204812, -1463940883, -1986414615, -566215251, 1447535318, -1364994072, -42137220, 1266861209, 1495623861, 645898029, -1400368560, 775731088, -1286390106, 744312392, 568891918, -1648159101, 1256344234, 234332239, -1718720897, 1732203195, 1843232014, -1905203797, 966150861, -1030300688, 1337601493, 291694994, 1886770376, 224891566, -1261489446, 221853017, 334715274, 74927848, -346221689, -469716197, -1685257741, 727766886, 2021997970, -1174609455, -190572335, -852490076, 506308252, -1942791559, -183897040, 81041013, -1908493630, 1847184706, -1231852965, 1089051169, 2031945564, 228953977, 259840755, -914081070, -1649257247, 1566725671, 870997111, -1279427483, -1442261862, 179054098, 1576465917, -603935484, -302875057, -1161147248, 1289103837, 856337247, -1129139505, 746326748, -1380563769, 1801761230, -478165045, 494007878, 183717558, -662026705, -448280913, -888086685, 816918157, 1084937881, -826549591, -2095195371, -943266155, -502483535, 1155874895, -155113990, 466981342, 1761968937, -1538692748, -71604066, -420966145, -1942300969, 2086114136, -1478780775, 80820999, 54835881, -307701965, 1879367235, 1708507181, -1607545093, 206490952, -1733477775, -1797837956, 471917259, 1756272199, 1046559445, -1691670060, -1591639657, -228614711, -774978774, 1020403264, 770233922, -365124260, 178000165, 1728717920, -229233556, 1555524539, 1526965388, -1734824754, -1238525347, 2096145350, -1876644888, 1551593584, -1630002909, -853815180, 431481813, -1469819400, -26933715, -764957391, -142151204, 1938482041, 794373852, 212862505, 1611883499, -846521946, -803485389, -2012179337, -356089390, -645350235, -8119037, -980203325, -383561552, -1557214424, -728902889, 1731960837, 1382232135, -1291517036, -181469523, 485062826, -935806652, 1707575283, 964898117, -2459134, 968407735, -1872744653, -671426894, -1028030546, -365420944, -613579596, 2095178515, 1621695567, 970390539, -949052130, 1204222216, 603359262, 2119201754, -515648626, -2123401665, 1978664862, -1504808707, 1273677975, 1789880825, -1111437677, 569974804, 1814949478, -1717325855, -1713483493, 1831370795, -2090753613, 1227502004, 1436951023, -824135330, 1282878937, -1380488392, -1943372720, -1695724051, -640143063, 983100227, 1761855337, -730745420, -1891825403, 1056115820, -27013502, 211542504, 820988515, 1934366291, 1538108132, 911356187, 222409000, 1526535987, -1172094339, 1732934183, 1181349635, 588615739, -293023563, 1519255199, -1884517297, 671513179, 1008027038, 1781542739, 1025855286, 1362835261, -1988891360, -771402802, -1195915826, 1222818136, 1590260058, 1793412772, -1466322799, 741410112, -615985806, -1485514818, 490160407, -2000261368, -2031567154, -1597760626, 427134620, 1246752614, -1162268065, -1265262150, -490339296, 1200333368, 924260336, 1395212801, -1577356794, 589842657, -1901663135, -254702536, 1575557392, -673245815, 2098610674, 2129785625, -213302152, -314043977, -1601985843, -428236276, 1017001382, -1636235574, -568890539, 198982129, 6808050, -633781458, -1823781218, -436101226, -1887305015, 1721622753, -1036609520, -1305469675, -26667890, -1010675230, 285531625, 863697805, 342716659, -1522449338, 1645561483, 1396109207, -395576609, -1450643271, -1472125588, 570100572, -1226671089, 1135297221, 360661618, -1134188549, -1984359333, 69452477, 134692551, 437669172, 847000097, 1087263743, 2093539698, 2047670229, -1222283342, 1087662892, -1468769110, -1059679416, -1289082234, 2099470580, 847190866, 1220604545, 488917719, -1190174777, 926763760, -137380849, -1730354790, -1007520259, 1079129723, -1627543705, 506874314, 1159213943, -1245400152, -1804574771, 1900518293, -411906767, 1541220124, -283566879, -265348181, 1862220078, 1378697584, -943678544, 638404635, -806762130, 1438685146, 1384387857, 1291633182, 345567993, -250820310, 664754848, -1089138004, -1045298532, -797699781)
"beta1" <- -0.250573751748674
"beta2" <- 0.749212973493406
"mu" <- structure(c(-4.96591905296019, -5.03402481281019, -5.17212431435377, -5.02137684482318, -5.10079780023382, -4.80202832465029, -4.04114380340659, -3.27278313815298, -4.76379327897456, -4.0330240948953, -5.4084175843306, -4.49693135741347, -2.16966959657964, -3.23706841529495, -4.82819629808255, -2.87167591246234, -5.43452933878918, -4.48951534866806, -3.02961521899313, -3.66428570283584, -5.7967855493056, -1.15842137348543, -3.58650309513678, -2.16564692731784, -4.48891772763734, -2.13356464375826, -3.46745675000499, -1.1247796799341, -4.01069630162238, -1.5125000689973, -6.06194268341094, -0.993303368111842, -4.28241915092279, -3.2087620324639, -4.36899241044496, 1.18917860499229, -2.76484115790666, -2.63944110748935, -4.48711701294367, -1.55189413500318, -2.91019981142717, 0.333187120344857, -1.31652960343386, -2.44518398711837, -2.6059094896391, -2.65343133678169, -1.72555246742117, -0.335365656848762, -0.231524805254138, -1.65205070650619, -1.07759072578692, -1.43583169265501, -2.02638260707557, 0.377169161487095, -1.02712027127276, -1.76209968831558, -1.06955819624567, -1.08677625600289, -1.73807592211231, 0.836802380348895, -1.86420930123316, 3.22098939348939, -1.2101260404858, -0.249735175897993, 0.228378112082412, 0.678751888902386, -1.64403308035197, 2.63305324603807, -1.40018787516155, -0.0903809412260938, -1.11432119133723, -0.353112175731656, 1.03322658612631, 3.6446619391017, 0.588763907209842, -2.86057275124484, -1.08072306627243, 0.282007190256297, 0.814124301933233, 1.87259616551847, 0.889337952303606, -0.989291907314565, 1.40445940710764, -0.270043220422302, 0.00596301394295062, 1.26497218542772, -0.293416427428097, -0.878522220539027, -0.230021223848959, 0.0653755377781524, -0.726861519840617, -0.947500481390281, -1.85936350743385, -0.973480352086062, 0.7564840440335, -0.453658248787147, -1.3819034493663, -1.76298415076363, -3.56091610265519, -1.78045262792191, 1.71455188457391, 2.21413713286067, 0.655746929860845, -2.63941466366247, -4.244035828859, -1.30812869729967, 1.56704035234163, -0.445908038290628, -0.523872982024768, -3.71322133904456, -3.65530547469271, -2.87249978096465, -0.327186057184524, -2.25601923882131, -0.466449239903584, -3.2759682435864, -5.64921775451802, -3.39603984040465, -1.0467765553628, -1.8568495691423), .Dim = c(6, 20))
"tau_obs" <- 1.877837118229
"tau_proc" <- 0.567446315244055
"y" <- structure(c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.999977111816406, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA), .Dim = c(6, 20))
".RNG.name" <- "base::Mersenne-Twister"
}



######################################################################################################
######################################################################################################
#### Data 
######################################################################################################
######################################################################################################

data{
"y" <- structure(c(-4.03152707120764, -2.93529161218665, -5.62682143352007, -5.62682143352007, -5.62682143352007, -5.62682143352007, -4.53998150125268, -1.8829167632122, -4.53998150125268, -5.62682143352007, -5.62682143352007, -4.53998150125268, NA, -4.03152707120764, -5.62682143352007, -2.93529161218665, -5.62682143352007, -5.62682143352007, -3.24501396923639, -3.69607278418884, -5.62682143352007, -1.93052454973515, -3.69607278418884, -1.98051263011772, -4.03152707120764, -2.599159384297, -4.53998150125268, -0.667675378933285, -3.69607278418884, -1.46987021066156, -5.62682143352007, 0.65628623540281, -5.62682143352007, -4.53998150125268, -3.69607278418884, 0.28244132921539, -2.50826153633297, -2.69915335566306, -5.62682143352007, -1.17841886197356, -2.69915335566306, 1.31678063749515, -1.53336559479944, -2.81026845882755, -1.53336559479944, -2.14748345118878, -2.599159384297, -0.0647350929898851, -0.588172732416592, -0.709929869344222, -1.83747285085108, -1.24986261508958, -2.50826153633297, 0.54376846842893, -0.210732315329934, -2.20996889324303, -1.46987021066156, -0.695645735349935, -1.00962988892068, 0.26631272211576, -1.02923492550756, 2.75680497289931, -0.167994031729581, -0.381749577096813, -0.613977641063735, 0.535521302888246, -2.599159384297, 3.57823231161518, -1.75234744552965, 0.163663803379496, -0.832202726691689, -0.538478581733032, 1.18094709209741, 3.79206814586865, 1.41252002700771, -1.83747285085108, -0.600991952385723, 0.896523437913746, -0.0132565196671187, 1.55366459645601, 0.870206817285757, -1.27485833361738, 1.06844556692761, -1.17841886197356, -0.575515767064287, -0.695645735349935, 0.0559709878508895, -0.381749577096813, 0.462530338014032, 0.139347815767006, -1.32680601191085, -0.899444848892466, -0.769198629580437, -0.563017000255943, 1.43803122711501, -0.899444848892466, -2.27662053844541, -1.8829167632122, -2.81026845882755, -0.434948554174057, 2.24568255766146, 0.678064974235618, 1.5186538863447, -2.93529161218665, -4.03152707120764, -1.11174073279749, 4.40232012370812, -2.27662053844541, NA, -4.03152707120764, -5.62682143352007, -3.69607278418884, -0.769198629580437, -4.03152707120764, -0.273811209873728, -3.07820942207549, -5.62682143352007, -3.4453243315358, -1.43957306512941, -2.03313160883806), .Dim = c(6, 20))
"year_no" <- c(1, 2, 3, 4, 5, 6)
"season_weeks" <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20)
"beta.m1" <- 0
"beta.m2" <- 0
"beta.v1" <- 0.001
"beta.v2" <- 0.001
"x_ic" <- -5
"tau_ic" <- 100
"a_proc" <- 0.001
"r_proc" <- 0.001
"a_obs" <- 15.37
"r_obs" <- 7.84


}

######################################################################################################
######################################################################################################
